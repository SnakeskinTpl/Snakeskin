var Snakeskin={VERSION:"1.5.2",Filters:{},BEM:{},Vars:{},write:{},cache:{}},SS=Snakeskin;
(function(L){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});String.prototype.trim||(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),f=a.length;/\s/.test(a.charAt(--f)););return a.substring(0,f+1)});Snakeskin.forEach=function(a,f){var d=-1,g,b;if(Array.isArray(a))for(g=a.length;++d<g;)f(a[d],d,0===d,d===g-1,g);else{d=0;for(b in a)a.hasOwnProperty(b)&&d++;g=d;d=-1;for(b in a)a.hasOwnProperty(b)&&(d++,f(a[b],b,d,0===d,d===g-
1,g))}};var aa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ba=/[&<>"'\/]/g,ca=function(a){return aa[a]};Snakeskin.Filters.html=function(a){return String(a).replace(ba,ca)};Snakeskin.Filters.undef=function(a){return"undefined"!==typeof a?a:""};var da={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},ea=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g,fa=function(a){return da[a]};Snakeskin.Filters.uhtml=function(a){return String(a).replace(ea,fa)};var ga=
/<\/?[^>]+>/g;Snakeskin.Filters.stripTags=function(a){return String(a).replace(ga,"")};var ha=/%5B/g,ia=/%5D/g;Snakeskin.Filters.uri=function(a){return encodeURI(String(a)).replace(ha,"[").replace(ia,"]")};Snakeskin.Filters.upper=function(a){return String(a).toUpperCase()};Snakeskin.Filters.ucfirst=function(a){a=String(a);return a.charAt(0).toUpperCase()+a.substring(1)};Snakeskin.Filters.lower=function(a){return String(a).toLowerCase()};Snakeskin.Filters.lcfirst=function(a){a=String(a);return a.charAt(0).toLowerCase()+
a.substring(1)};Snakeskin.Filters.trim=function(a){return String(a).trim()};var ja=/\s{2,}/g;Snakeskin.Filters.collapse=function(a){return String(a).replace(ja," ").trim()};Snakeskin.Filters.truncate=function(a,f,d){a=String(a);if(!a||a.length<=f)return a;a=a.substring(0,f-1);var g;for(f=a.length;f--&&d;)if(" "===a.charAt(f))g=f;else if("undefined"!==typeof g)break;return("undefined"!==typeof g?a.substring(0,g):a)+"\u2026"};Snakeskin.Filters.repeat=function(a,f){return Array(f||2).join(a)};Snakeskin.Filters.remove=
function(a,f){return String(a).replace(f,"")};Snakeskin.Filters.replace=function(a,f,d){return String(a).replace(f,d)};Array.prototype.forEach||(Array.prototype.forEach=function(a,f){var d=-1,g=this.length;if(f)for(;++d<g;)a.call(f,this[d],d,this);else for(;++d<g;)a(this[d],d,this)});Array.prototype.some||(Array.prototype.some=function(a,f){var d=-1,g=this.length,b;if(f)for(;++d<g;){if(b=a.call(f,this[d],d,this))return!0}else for(;++d<g;)if(b=a(this[d],d,this))return!0;return!1});Array.prototype.reduce||
(Array.prototype.reduce=function(a,f){var d=0,g=this.length,b;if(1===g)return this[0];for(b="undefined"!==typeof f?f:this[0];++d<g;)b=a(b,this[d],d,this);return b});var M={},G={},w={},Q={},X={},H={},R={},N={},x={},S={},U=[],ka={'"':!0,"'":!0},la={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_CDATA__:!0},l;Snakeskin._escape=function(a,f){return a.replace(/(["']).*?[^\\]\1/g,function(a){f&&f.push(a);return"__SNAKESKIN_QUOT__"+(f?f.length-1:"_")})};Snakeskin._uescape=function(a,f){return a.replace(/__SNAKESKIN_QUOT__(\d+)/g,
function(a,g){return f[g]})};Snakeskin._getExtStr=function(a,f){if("undefined"===typeof M[S[a]])throw l=Error('The specified pattern ("'+S[a]+'" for "'+a+'") for inheritance is not defined ('+this._genError(f)+")!"),l.name="Snakeskin Error",l;for(var d=S[a],g=M[d],b,j,k,e,h=-1,p,n=0,z=[],x,m,t;6>++h;)for(e in 0===h?(b=G[a],j=G[d]):2===h?(b=H[a],j=H[d],n=R[d],p=null):4===h&&(b=w[a],j=w[d],n=Q[d],p=null),b)if(b.hasOwnProperty(e))if(t=0,k=M[a].substring(b[e].from,b[e].to),j[e]&&(x=k.length-M[d].substring(j[e].from,
j[e].to).length),m=j[e]?j[e].from:n,z.sort(function(a,b){if(a.val>b.val)return 1;if(a.val===b.val)return 0;if(a.val<b.val)return-1}).some(function(a){if(a.val<m)t+=a.adv;else return!0}),j[e]&&0===h%2)1<h&&(p=j[e].from+t+k.length,n+=x,p>n&&(n=p+(4===h?5:1))),g=g.substring(0,j[e].from+t)+k+g.substring(j[e].to+t),z.push({val:j[e].from,adv:x});else if(!j[e])if(1===h)g+="{"+e+"}"+k+"{end}";else if(3===h||5===h)null===p&&(p=n,n+=t),k=3===h?"{"+k+"}":"{"+e+"}"+k+"{end}",g=g.substring(0,n)+k+g.substring(n),
z.push({val:p,adv:k.length}),n+=k.length;return g};Snakeskin._genError=function(a){var f,d="";for(f in a)a.hasOwnProperty(f)&&(d=a[f].innerHTML?d+(f+": (class: "+(a[f].className||"undefined")+", id: "+(a[f].id||"undefined")+"), "):d+(f+": "+a[f]+", "));return d.replace(/, $/,"")};Snakeskin.compile=function(a,f,d,g){g=g||{};a.innerHTML&&(g.node=a);a=String(a.innerHTML||a).replace(/{cdata}([\s\S]*?){end\s+cdata}/gm,function(a,b){U.push(b);return"__SNAKESKIN_CDATA__"+(U.length-1)}).replace(/\/\/.*/gm,
"").replace(/[\t\v\r\n]/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").trim();for(var b=""+(!d?"/* This code is generated automatically, don't alter it. */":"")+(f?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":""),j,k,e=null,h,p,n,z,F=0,m=0,t,C=[],A,y=[],u,s,V=0,Y,D={},E=[],O,P=[],W,J=[],Z={},I,c="",T,q,$,B=[],r=-1,v,K;++r<a.length;){j=a.charAt(r);if(!K)if("{"===j)if(z)F++;else{z=!0;continue}else if("}"===j&&(!F||!F--)){z=
!1;I=c.length;c=this._escape(c,B).trim();switch(c.split(" ")[0]){case "template":if(0!==m)throw l=Error("Missing closing or opening tag in the template (command: {"+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;m++;v=r+1;e=j=/^template\s+(.*?)\(/.exec(c)[1];e=this._uescape(e,B);k=!1!==this.write[e];if(d)break;/\s+extends\s+/.test(c)&&(h=this._uescape(/\s+extends\s+(.*)/.exec(c)[1],B));p=c.replace(/.*?\((.*?)\).*/,"$1");G[e]={};w[e]={};Q[e]=0;H[e]={};R[e]=0;N[e]={};
S[e]=h;k&&(b+="/* Snakeskin template: "+e+"; "+p.replace(/=(.*?)(?:,|$)/g,"")+" */");/\.|\[/.test(j)||f?(j.replace(/\[/g,".").replace(/]/g,"").split(".").reduce(function(a,c,e){Z[a]||(k&&(b+="if (typeof "+(f?"exports.":"")+a+" === 'undefined') { "+(f?"exports.":1===e?L?"var ":"window.":"")+a+" = {}; }"),Z[a]=!0);return"__SNAKESKIN_QUOT__"===c.substring(0,18)?a+"["+c+"]":a+"."+c}),k&&(b+=(f?"exports.":"")+j+"= function (")):k&&(b+=(!L?"window."+j+" = ":"")+"function "+(L?j:"")+"(");p=p.split(",");
x[e]=x[h]?x[h].concat(p):p;n="";x[h]&&x[h].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();p.forEach(function(c,e){var d=c.split("=");d[0]=d[0].trim();d[1]=d[1]&&d[1].trim();b[0]===d[0]&&"undefined"===typeof d[1]&&(p[e]=a)})});p.forEach(function(a,c){var d=a.split("=");d[0]=d[0].trim();k&&(b+=d[0]);1<d.length&&(x[h]&&!n&&x[h].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();!p.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&
a[1].trim();return a[0]===b[0]})&&"undefined"!==typeof b[1]&&(n+="var "+b[0]+" = "+b[1]+";",N[e][b[0]]=a)}),d[1]=d[1].trim(),n+=d[0]+" = typeof "+d[0]+" !== 'undefined' && "+d[0]+" !== null ? "+d[0]+" : "+d[1]+";");N[e][d[0]]=a;c!==p.length-1&&k&&(b+=",")});k&&(b+=") { "+n+"var __SNAKESKIN_RESULT__ = '';");break;case "cut":c=this._uescape(c.replace(/^cut\s+/,""),B);this.write[c]||(this.write[c]=!1);break;case "save":this.write[this._uescape(c.replace(/^save\s+/,""),B)]=!0;break;case "if":m++;!h&&
!s&&k&&(b+="if ("+c.replace(/^if\s+/,"")+") {");break;case "elseIf":!h&&!s&&k&&(b+="} else if ("+c.replace(/^elseIf\s+/,"")+") {");break;case "else":!h&&!s&&k&&(b+="} else {");break;case "with":E.push({scope:c.replace(/^with\s+/,""),i:++m});break;case "proto":if(!d&&(h&&!C.length&&!y.length||!h)){if(w[e][c])throw l=Error('Proto "'+c.replace(/^proto\s+/,"")+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;w[e][c]={from:r-v+1}}y.push({name:c,
i:++m,startI:r+1});h||(s=!0);break;case "apply":!h&&!y.length&&(c=c.replace(/^apply/,"proto"),w[e][c]?k&&(b+=w[e][c].body):(D[c]||(D[c]=[],D[c].protoStart=s,Y=c.replace(/^proto\s+/,""),V++),D[c].push(b.length)));break;case "block":if(!d&&(h&&!C.length&&!y.length||!h)){if(G[e][c])throw l=Error('Block "'+c.replace(/^block\s+/,"")+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;G[e][c]={from:r-v+1}}C.push({name:c,i:++m});break;case "forEach":P.push(++m);
!h&&!s&&(c=c.replace(/^forEach\s+/,"").split("=>"),k&&(b+=c[0]+" && Snakeskin.forEach("+c[0]+", function ("+(c[1]||"")+") {"));break;case "setBEM":c=c.replace(/^setBEM\s+/,"").match(/(.*?)\s+(.*)/);this.BEM[c[1]]=(new Function("return "+this._uescape(c[2],B)))();break;case "bem":J.push({i:++m,tag:/\(/g.test(c)?/\((.*?)\)/.exec(c)[1]:null});j=J[J.length-1];c=j.tag?c.replace(/^.*?\)([\s\S]*)/,"$1"):c.substring(3);c=c.trim().split(",");A=c[0];j.original=this.BEM[A]&&this.BEM[A].tag;!h&&!s&&(c[0]+="'",
c=c.join(","),k&&(b+="__SNAKESKIN_RESULT__ += '<"+(j.tag||j.original||"div")+' class="i-bem" data-params="{name: \\\''+this._uescape(c,B).replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")+"}\">';"));break;case "end":m--;A=C[C.length-1];u=y[y.length-1];O=E[E.length-1];W=P[P.length-1];j=J[J.length-1];if(0===m){if(V)throw l=Error('Proto "'+Y+'" is not defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;if(d)break;M[e]=a.substring(v,r-I-1);if(h){a=a.substring(0,
v)+this._getExtStr(e,g)+a.substring(r-I-1);G[e]={};w[e]={};Q[e]=0;H[e]={};R[e]=0;N[e]={};r=v-1;m++;!1===this.write[h]&&(b=b.replace(RegExp("/\\* Snakeskin template: "+h.replace(/([.\[\]^$])/g,"\\$1")+";[\\s\\S]*?/\\* Snakeskin template\\. \\*/","m"),""));t=z=h=!1;c="";continue}k&&(b+="return __SNAKESKIN_RESULT__; };if (typeof Snakeskin !== 'undefined') {Snakeskin.cache['"+this._uescape(e,B).replace(/'/g,"\\'")+"'] = "+(f?"exports.":"")+e+";}/* Snakeskin template. */");k=!0;e=null}else if(!h&&(!u||
u.i!==m+1)&&(!A||A.i!==m+1)&&(!O||O.i!==m+1))W===m+1?s||k&&(b+="});"):j&&j.i===m+1?s||k&&(b+="__SNAKESKIN_RESULT__ += '</"+(j.tag||j.original||"div")+">';"):s||k&&(b+="};");W===m+1&&P.pop();j&&j.i===m+1&&J.pop();if(A&&A.i===m+1&&(C.pop(),!d&&(h&&!C.length&&!y.length||!h)))G[e][A.name].to=r-v-I-1;if(u&&u.i===m+1){y.pop();if(!d&&(h&&!C.length&&!y.length||!h))w[e][u.name].to=r-v-I-1,Q[e]=r-v+1;h||(w[e][u.name].body=this.compile("{template "+e+"()}"+a.substring(u.startI,r-I-1)+"{end}",null,!0));D[u.name]&&
!D[u.name].protoStart&&(D[u.name].forEach(function(a){k&&(b=b.substring(0,a)+w[e][u.name].body+b.substring(a))}),delete D[u.name],V--);y.length||(s=!1)}O&&O.i===m+1&&E.pop();break;default:if(!h&&!s&&/console\./.test(c)){k&&(b+=c+";");break}if(/=(?!=)/.test(c))if(q=c.split("=")[0].trim(),e){if(H[e][q]||N[e][q])throw l=Error('Variable "'+q+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;if(la[q])throw l=Error("Can't declare variable \""+
q+'", try another name (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;if(P.length)throw l=Error('Variable "'+q+"\" can't be defined in a loop (command: {"+c+'}, template: "'+e+", "+this._genError(g)+'")!'),l.name="Snakeskin Error",l;H[e][q]={from:r-v-I,to:r-v};R[e]=r-v+1;!h&&!s&&k&&(b+="var "+c+";")}else X[q]=!0,k&&(b+="if (typeof Snakeskin !== 'undefined') { Snakeskin.Vars."+c+"; }");else!h&&!s&&(q="",$=1,T=!1,c.replace(/\|\|/g,"__SNAKESKIN_ESCAPE__OR").split("|").forEach(function(a,
b){var c,d;0===b?(E.length?(E.push({scope:a}),q=E.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),E.pop()):q=a,q="Snakeskin.Filters.undef("+(!H[e][q]&&X[q]?"Snakeskin.Vars.":"")+q+")"):(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?($++,q="Snakeskin.Filters['"+c[0]+"']("+q+(d.length?", "+d.join(""):"")+")"):T=!0)}),k&&(b+="__SNAKESKIN_RESULT__ += "+(!T?"Snakeskin.Filters.html(":"")+q+(!T?")":"")+";"))}c="";continue}if(z){!s&&t&&(k&&(b+="';"),t=!1);if((ka[j]||"/"===j)&&
(!a[r-1]||"\\"!==a[r-1]))K&&K===j?K=!1:K||(K=j);c+=j}else s||(t||(k&&(b+="__SNAKESKIN_RESULT__ += '"),t=!0),h||k&&(b+=j))}b=this._uescape(b,B).replace(/__SNAKESKIN_ESCAPE__OR/g,"||").replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return U[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");b+=!d?"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */":"";b+=f?"}":"";if(0!==m)throw l=Error("Missing closing or opening tag in the template (template: "+
e+", "+this._genError(g)+")!"),l.name="Snakeskin Error",l;if(d)return b;L?f?eval(b):global.eval(b):window.eval(b);return b};var F;if(L)for(F in Snakeskin)Snakeskin.hasOwnProperty(F)&&(exports[F]=Snakeskin[F])})("undefined"===typeof window);
