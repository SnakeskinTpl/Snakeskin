/**!
 * @status stable
 * @version 1.0.0
 */

DirObj.prototype.varCache = {
	init: function () {
		return {};
	}
};

Snakeskin.addDirective(
	'var',

	{
		placement: 'template',
		replacers: {
			':': (cmd) => cmd.replace(/^:/, 'var ')
		}
	},

	function (command) {
		if (!command) {
			throw this.error('Invalid syntax');
		}

		this.startInlineDir();
		if (this.isSimpleOutput()) {
			let struct = command.split('='),
				realVar = this.declVar(struct[0].trim());

			struct[0] = realVar + ' ';
			this.save(this.prepareOutput('var ' + struct.join('=') + ';', true));
		}
	}
);