var Snakeskin={VERSION:"2.2.6",Directions:{},Filters:{},BEM:{},Vars:{},write:{},cache:{}};
(function(s){Array.isArray||(Array.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)});String.prototype.trim||(String.prototype.trim=function(){for(var b=this.replace(/^\s\s*/,""),d=b.length;/\s/.test(b.charAt(--d)););return b.substring(0,d+1)});Snakeskin.forEach=function(b,d,a){var e=-1,c,f;if(Array.isArray(b))for(c=b.length;++e<c;)if(a){if(!1===d.call(a,b[e],e,0===e,e===c-1,c))break}else{if(!1===d(b[e],e,0===e,e===c-1,c))break}else{e=0;for(f in b)b.hasOwnProperty(f)&&
e++;c=e;e=-1;for(f in b)if(b.hasOwnProperty(f))if(e++,a){if(!1===d.call(a,b[f],f,e,0===e,e===c-1,c))break}else if(!1===d(b[f],f,e,0===e,e===c-1,c))break}};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},E=/[&<>"'\/]/g,F=function(b){return D[b]};Snakeskin.Filters.html=function(b){return String(b).replace(E,F)};Snakeskin.Filters.undef=function(b){return"undefined"!==typeof b?b:""};var G={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},H=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g,
I=function(b){return G[b]};Snakeskin.Filters.uhtml=function(b){return String(b).replace(H,I)};var J=/<\/?[^>]+>/g;Snakeskin.Filters.stripTags=function(b){return String(b).replace(J,"")};var K=/%5B/g,L=/%5D/g;Snakeskin.Filters.uri=function(b){return encodeURI(String(b)).replace(K,"[").replace(L,"]")};Snakeskin.Filters.upper=function(b){return String(b).toUpperCase()};Snakeskin.Filters.ucfirst=function(b){b=String(b);return b.charAt(0).toUpperCase()+b.substring(1)};Snakeskin.Filters.lower=function(b){return String(b).toLowerCase()};
Snakeskin.Filters.lcfirst=function(b){b=String(b);return b.charAt(0).toLowerCase()+b.substring(1)};Snakeskin.Filters.trim=function(b){return String(b).trim()};var M=/\s{2,}/g;Snakeskin.Filters.collapse=function(b){return String(b).replace(M," ").trim()};Snakeskin.Filters.truncate=function(b,d,a){b=String(b);if(!b||b.length<=d)return b;b=b.substring(0,d-1);var e;for(d=b.length;d--&&a;)if(" "===b.charAt(d))e=d;else if("undefined"!==typeof e)break;return("undefined"!==typeof e?b.substring(0,e):b)+"\u2026"};
Snakeskin.Filters.repeat=function(b,d){return Array(d||2).join(b)};Snakeskin.Filters.remove=function(b,d){return String(b).replace(d,"")};Snakeskin.Filters.replace=function(b,d,a){return String(b).replace(d,a)};Snakeskin.Filters.json=function(b){return"object"===typeof b?JSON.stringify(b):String(b)};Array.prototype.reduce||(Array.prototype.reduce=function(b,d){var a=0,e=this.length,c;if(1===e)return this[0];for(c="undefined"!==typeof d?d:this[0];++a<e;)c=b(c,this[a],a,this);return c});var t={},n=
{},m={},v={},B={},p={},w={},u={},q={},x={},y=[],N={'"':!0,"'":!0},O={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_CDATA__:!0};Snakeskin._escape=function(b,d){return b.replace(/(["'])(?:\\[\S\s]|(?:(?!\1|\\)[\S\s]))*\1/g,function(a){d&&d.push(a);return"__SNAKESKIN_QUOT__"+(d?d.length-1:"_")})};Snakeskin._uescape=function(b,d){return b.replace(/__SNAKESKIN_QUOT__(\d+)/g,function(a,b){return d[b]})};Snakeskin._getExtStr=function(b,d){if("undefined"===typeof t[x[b]])throw this.error('The specified pattern ("'+
x[b]+'" for "'+b+'") for inheritance is not defined ('+this._genErrorAdvInfo(d)+")!");for(var a=x[b],e=t[a],c,f,h,g,j=-1,l,k=0,z=[],A,C,r;6>++j;)for(g in 0===j?(c=n[b],f=n[a]):2===j?(c=p[b],f=p[a],k=w[a],l=null):4===j&&(c=m[b],f=m[a],k=v[a],l=null),c)if(c.hasOwnProperty(g))if(r=0,h=t[b].substring(c[g].from,c[g].to),f[g]&&(A=h.length-t[a].substring(f[g].from,f[g].to).length),C=f[g]?f[g].from:k,this.forEach(z.sort(function(a,b){if(a.val>b.val)return 1;if(a.val===b.val)return 0;if(a.val<b.val)return-1}),
function(a){if(a.val<C)r+=a.adv;else return!1}),f[g]&&0===j%2)1<j&&(l=f[g].from+r+h.length,k+=A,l>k&&(k=l+(4===j?5:1))),e=e.substring(0,f[g].from+r)+h+e.substring(f[g].to+r),z.push({val:f[g].from,adv:A});else if(!f[g])if(1===j)e+="{block "+g+"}"+h+"{end}";else if(3===j||5===j)null===l&&(l=k,k+=r),h=3===j?"{"+h+"}":"{proto "+g+"}"+h+"{end}",e=e.substring(0,k)+h+e.substring(k),z.push({val:l,adv:h.length}),k+=h.length;return e};Snakeskin._genErrorAdvInfo=function(b){var d,a="";for(d in b)b.hasOwnProperty(d)&&
(a=b[d].innerHTML?a+(d+": (class: "+(b[d].className||"undefined")+", id: "+(b[d].id||"undefined")+"), "):a+(d+": "+b[d]+", "));return a.replace(/, $/,"")};Snakeskin.error=function(b){b=Error(b);b.name="Snakeskin Error";return b};Snakeskin.compile=function(b,d,a,e){e=e||{};b.innerHTML&&(e.node=b);var c={i:-1,openBlockI:0,nmCache:{},posCache:{},sysPosCache:{},backHashI:0,backHash:{},lastBack:null,quotContent:[],source:String(b.innerHTML||b).replace(/{cdata}([\s\S]*?){(?:\/cdata|end\s+cdata)}/gm,function(a,
b){y.push(b);return"__SNAKESKIN_CDATA__"+(y.length-1)}).replace(/\/\/\/.*/gm,"").replace(/[\t\v\r\n]/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").trim(),res:""+(!a?"/* This code is generated automatically, don't alter it. */":"")+(d?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":""),save:function(a){if(!c.tplName||!1!==Snakeskin.write[c.tplName])c.res+=a},replace:function(a){c.canWrite&&(c.res=a)},pushPos:function(a,
b,d){d?(c.sysPosCache[a]||(c.sysPosCache[a]=[]),c.sysPosCache[a].push(b)):(c.posCache[a]||(c.posCache[a]=[]),c.posCache[a].push(b))},popPos:function(a){return c.sysPosCache[a]?c.sysPosCache[a].pop():c.posCache[a].pop()},getPos:function(a){return c.sysPosCache[a]?c.sysPosCache[a]:c.posCache[a]},hasPos:function(a){return c.sysPosCache[a]?c.sysPosCache[a].length:!(!c.posCache[a]||!c.posCache[a].length)},getLastPos:function(a){if(c.sysPosCache[a]){if(c.sysPosCache[a].length)return c.sysPosCache[a][c.sysPosCache[a].length-
1]}else if(c.posCache[a]&&c.posCache[a].length)return c.posCache[a][c.posCache[a].length-1]},isNotSysPos:function(a){var b=!0;Snakeskin.forEach(this.sysPosCache,function(d,e){if((d=c.getLastPos(e))&&("undefined"!==typeof d.i&&d.i===a||d===a))return b=!1});return b}},f;b=0;for(var h,g="",j,l,k;++c.i<c.source.length;){j=c.source.charAt(c.i);if(!k)if("{"===j)if(f)b++;else{f=!0;continue}else if("}"===j&&(!b||!b--)){f=!1;l=g.length;g=this._escape(g,c.quotContent).trim();j=g.replace(/^\//,"end ").split(" ")[0];
j=this.Directions[j]?j:"const";g=this.Directions[j].call(this,"const"!==j?g.replace(RegExp("^"+j+"\\s+"),""):g,l,c,{commonJS:d,dryRun:a,info:e});!1===g&&(h=f=!1);g="";continue}if(f){!c.protoStart&&h&&(c.save("';"),h=!1);if((N[j]||"/"===j&&g.length)&&(!c.source[c.i-1]||"\\"!==c.source[c.i-1]))k&&k===j?k=!1:k||(k=j);g+=j}else c.protoStart||(h||(c.save("__SNAKESKIN_RESULT__ += '"),h=!0),c.parentTplName||c.save(j.replace(/\\/gm,"\\\\").replace(/'/gm,"\\'")))}if(0!==c.openBlockI)throw this.error("Missing closing or opening tag in the template, "+
this._genErrorAdvInfo(e)+'")!');c.res=this._uescape(c.res,c.quotContent).replace(/__SNAKESKIN_ESCAPE__OR/g,"||").replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return y[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");c.res+=!a?"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */":"";c.res+=d?"}":"";if(a)return c.res;s?d?eval(c.res):global.eval(c.res):window.eval(c.res);return c.res};
Snakeskin.Directions.template=function(b,d,a,e){var c=this,f,h,g,j="";a.startI=a.i+1;d=/(.*?)\(/.exec(b)[1];a.tplName=f=this._uescape(d,a.quotContent);if(0!==a.openBlockI)throw this.error("Missing closing or opening tag in the template (command: {"+b+'}, template: "'+f+", "+this._genErrorAdvInfo(e.info)+'")!');a.openBlockI++;e.dryRun||(/\s+extends\s+/.test(b)&&(a.parentTplName=h=this._uescape(/\s+extends\s+(.*)/.exec(b)[1],a.quotContent)),n[f]={},m[f]={},v[f]=0,p[f]={},w[f]=0,u[f]={},x[f]=h,g=/\((.*?)\)/.exec(b)[1],
a.save("/* Snakeskin template: "+f+"; "+g.replace(/=(.*?)(?:,|$)/g,"")+" */"),/\.|\[/.test(d)||e.commonJS?(d.replace(/\[/g,".").replace(/]/g,"").split(".").reduce(function(b,c,d){a.nmCache[b]||(a.save("if (typeof "+(e.commonJS?"exports.":"")+b+" === 'undefined') { "+(e.commonJS?"exports.":1===d?s?"var ":"window.":"")+b+" = {}; }"),a.nmCache[b]=!0);return"__SNAKESKIN_QUOT__"===c.substring(0,18)?b+"["+c+"]":b+"."+c}),a.save((e.commonJS?"exports.":"")+d+"= function (")):a.save((!s?"window."+d+" = ":
"")+"function "+(s?d:"")+"("),g=g.split(","),q[f]=q[h]?q[h].concat(g):g,q[h]&&this.forEach(q[h],function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();c.forEach(g,function(c,d){var e=c.split("=");e[0]=e[0].trim();e[1]=e[1]&&e[1].trim();b[0]===e[0]&&"undefined"===typeof e[1]&&(g[d]=a)})}),this.forEach(g,function(b,d){var e=b.split("=");e[0]=e[0].trim();a.save(e[0]);1<e.length&&(q[h]&&!j&&c.forEach(q[h],function(a){var b=a.split("="),d;b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();c.forEach(g,
function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();if(a[0]===b[0])return d=!0,!1});!d&&"undefined"!==typeof b[1]&&(j+="var "+b[0]+" = "+b[1]+";",u[f][b[0]]=a)}),e[1]=e[1].trim(),j+=e[0]+" = typeof "+e[0]+" !== 'undefined' && "+e[0]+" !== null ? "+e[0]+" : "+e[1]+";");u[f][e[0]]=b;d!==g.length-1&&a.save(",")}),a.save(") { "+j+"var __SNAKESKIN_RESULT__ = '';"),a.save("var TPL_NAME = '"+d+"';"),h&&a.save("var PARENT_TPL_NAME = '"+h+"';"))};Snakeskin.Directions.templateEnd=function(b,
d,a,e){var c=a.tplName,f=a.parentTplName,h=a.source,g=a.i,j=a.startI;if(a.backHashI)throw this.error('Proto "'+a.lastBack+'" is not defined (command: {'+b+'}, template: "'+c+", "+this._genErrorAdvInfo(e.info)+'")!');if(!e.dryRun){t[c]=h.substring(j,g-d-1);if(f)return a.source=h.substring(0,j)+this._getExtStr(c,e.info)+h.substring(g-d-1),n[c]={},m[c]={},v[c]=0,p[c]={},w[c]=0,u[c]={},a.i=j-1,a.openBlockI++,!1===this.write[f]&&(a.res=a.res.replace(RegExp("/\\* Snakeskin template: "+f.replace(/([.\[\]^$])/g,
"\\$1")+";[\\s\\S]*?/\\* Snakeskin template\\. \\*/","m"),"")),a.parentTplName=!1;a.save("return __SNAKESKIN_RESULT__; };if (typeof Snakeskin !== 'undefined') {Snakeskin.cache['"+this._uescape(c,a.quotContent).replace(/'/g,"\\'")+"'] = "+(e.commonJS?"exports.":"")+c+";}/* Snakeskin template. */");a.canWrite=!0;a.tplName=null}};Snakeskin.Directions.call=function(b,d,a){!a.parentTplName&&!a.protoStart&&a.save("__SNAKESKIN_RESULT__ += "+b+";")};Snakeskin.Directions["void"]=function(b,d,a){!a.parentTplName&&
!a.protoStart&&a.save(b+";")};Snakeskin.Directions.block=function(b,d,a,e){d=a.tplName;if(!e.dryRun&&(a.parentTplName&&!a.hasPos("block")&&!a.hasPos("proto")||!a.parentTplName)){if(n[d][b])throw this.error('Block "'+b+'" is already defined (command: {block '+b+'}, template: "'+d+", "+this._genErrorAdvInfo(e.info)+'")!');n[d][b]={from:a.i-a.startI+1}}a.pushPos("block",{name:b,i:++a.openBlockI},!0)};Snakeskin.Directions.blockEnd=function(b,d,a,e){b=a.popPos("block");if(!e.dryRun&&(a.parentTplName&&
!a.hasPos("block")&&!a.hasPos("proto")||!a.parentTplName))n[a.tplName][b.name].to=a.i-a.startI-d-1};Snakeskin.Directions.proto=function(b,d,a,e){d=a.tplName;var c=a.parentTplName;if(!e.dryRun&&(c&&!a.hasPos("block")&&!a.hasPos("proto")||!c)){if(m[d][b])throw this.error('Proto "'+b+'" is already defined (command: {proto'+b+'}, template: "'+d+", "+this._genErrorAdvInfo(e.info)+'")!');m[d][b]={from:a.i-a.startI+1}}a.pushPos("proto",{name:b,i:++a.openBlockI,startI:a.i+1},!0);c||(a.protoStart=!0)};Snakeskin.Directions.protoEnd=
function(b,d,a,e){var c=a.tplName;b=a.parentTplName;var f=a.i,h=a.backHash,g=a.popPos("proto");if(!e.dryRun&&(b&&!a.hasPos("block")&&!a.hasPos("proto")||!b))m[c][g.name].to=f-a.startI-d-1,v[c]=f-a.startI+1;b||(m[c][g.name].body=this.compile("{template "+c+"()}"+a.source.substring(g.startI,f-d-1)+"{end}",null,!0));h[g.name]&&!h[g.name].protoStart&&(this.forEach(h[g.name],function(b){a.replace(a.res.substring(0,b)+m[c][g.name].body+a.res.substring(b))}),delete h[g.name],a.backHashI--);a.hasPos("proto")||
(a.protoStart=!1)};Snakeskin.Directions.apply=function(b,d,a){!a.parentTplName&&!a.hasPos("proto")&&(m[a.tplName][b]?a.save(m[a.tplName][b].body):(a.backHash[b]||(a.backHash[b]=[],a.backHash[b].protoStart=a.protoStart,a.lastBack=b,a.backHashI++),a.backHash[b].push(a.res.length)))};Snakeskin.Directions.forEach=function(b,d,a){a.pushPos("forEach",++a.openBlockI);!a.parentTplName&&!a.protoStart&&(b=b.split("=>"),a.save(b[0]+" && Snakeskin.forEach("+b[0]+", function ("+(b[1]||"")+") {"))};Snakeskin.Directions.forEachEnd=
function(b,d,a){a.popPos("forEach");!a.parentTplName&&!a.protoStart&&a.save("}, this);")};Snakeskin.Directions["if"]=function(b,d,a){a.openBlockI++;!a.parentTplName&&!a.protoStart&&a.save("if ("+b+") {")};Snakeskin.Directions.elseIf=function(b,d,a){!a.parentTplName&&!a.protoStart&&a.save("} else if ("+b+") {")};Snakeskin.Directions["else"]=function(b,d,a){!a.parentTplName&&!a.protoStart&&a.save("} else {")};Snakeskin.Directions["with"]=function(b,d,a){a.pushPos("with",{scope:b,i:++a.openBlockI},!0)};
Snakeskin.Directions.withEnd=function(b,d,a){a.popPos("with")};Snakeskin.Directions["const"]=function(b,d,a,e){var c,f=a.tplName,h=a.parentTplName,g=a.protoStart,j=a.i,l=a.startI;if(!h&&!g&&/console\./.test(b))a.save(b+";");else if(/[^=]=[^=]/.test(b))if(c=b.split("=")[0].trim(),f){if(p[f][c]||u[f][c])throw this.error('Variable "'+c+'" is already defined (command: {'+b+'}, template: "'+f+", "+this._genErrorAdvInfo(e.info)+'")!');if(O[c])throw this.error("Can't declare variable \""+c+'", try another name (command: {'+
b+'}, template: "'+f+", "+this._genErrorAdvInfo(e.info)+'")!');if(a.hasPos("forEach"))throw this.error('Variable "'+c+"\" can't be defined in a loop (command: {"+b+'}, template: "'+f+", "+this._genErrorAdvInfo(e.info)+'")!');p[f][c]={from:j-l-d,to:j-l};w[f]=j-l+1;!h&&!g&&a.save("var "+b+";")}else B[c]=!0,a.save("if (typeof Snakeskin !== 'undefined') { Snakeskin.Vars."+b+"; }");else!h&&!g&&a.save("__SNAKESKIN_RESULT__ += "+this._returnVar(b,a)+";")};Snakeskin._returnVar=function(b,d){var a="",e=!1;
this.forEach(b.replace(/\|\|/g,"__SNAKESKIN_ESCAPE__OR").split("|"),function(b,f){var h,g;0===f?(d.hasPos("with")?(d.pushPos("with",{scope:b},!0),a=d.getPos("with").reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),d.popPos("with")):a=b,a="Snakeskin.Filters.undef("+(!p[d.tplName][a]&&B[a]?"Snakeskin.Vars.":"")+a+")"):(h=b.split(" "),g=h.slice(1),"!html"!==h[0]?a="Snakeskin.Filters['"+h[0]+"']("+a+(g.length?", "+g.join(""):"")+")":e=!0)});return(!e?"Snakeskin.Filters.html(":
"")+a+(!e?")":"")};Snakeskin.Directions.cut=function(b,d,a){b=this._uescape(b,a.quotContent);this.write[b]||(this.write[b]=!1)};Snakeskin.Directions.save=function(b,d,a){this.write[this._uescape(b,a.quotContent)]=!0};Snakeskin.Directions.setBEM=function(b,d,a){b=b.match(/(.*?),\s+(.*)/);this.BEM[b[1]]=(new Function("return {"+this._uescape(b[2],a.quotContent)+"}"))()};Snakeskin.Directions.bem=function(b,d,a){a.pushPos("bem",{i:++a.openBlockI,tag:/^\(/g.test(b)?/\((.*?)\)/.exec(b)[1]:null});var e=
this;d=a.getLastPos("bem");var c,f;b=d.tag?b.replace(/^.*?\)([\s\S]*)/,"$1"):b;f=b.trim().split(",");c=f[0];d.original=this.BEM[c]&&this.BEM[c].tag;!a.parentTplName&&!a.protoStart&&(f[0]+="'",b=f.join(","),f=e._uescape(b,a.quotContent).split("${"),b="",this.forEach(f,function(c,d){var f;0<d?(f=c.split("}"),b+="' + "+e._returnVar(f[0],a)+" + '"+f.slice(1).join("}").replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")):b+=c.replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")}),a.save("__SNAKESKIN_RESULT__ += '<"+
(d.tag||d.original||"div")+' class="i-block" data-params="{name: \\\''+b+"}\">';"))};Snakeskin.Directions.bemEnd=function(b,d,a){b=a.popPos("bem");!a.parentTplName&&!a.protoStart&&a.save("__SNAKESKIN_RESULT__ += '</"+(b.tag||b.original||"div")+">';")};Snakeskin.Directions.data=function(b,d,a){var e=this;!a.parentTplName&&!a.protoStart&&(d=e._uescape(b,a.quotContent).split("${"),b="",2>d.length?a.save("__SNAKESKIN_RESULT__ += '"+d[0].replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")+"';"):(this.forEach(d,
function(c,d){var h;0<d?(h=c.split("}"),b+="' + "+e._returnVar(h[0],a)+" + '"+h.slice(1).join("}").replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")):b+=c.replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")}),a.save("__SNAKESKIN_RESULT__ += '"+b+"';")))};Snakeskin.Directions.end=function(b,d,a,e){a.openBlockI--;var c=this,f=arguments,h=a.openBlockI+1,g;0===a.openBlockI?this.Directions.templateEnd.apply(this,arguments):a.isNotSysPos(h)&&(this.forEach(a.posCache,function(b,d){if((b=a.getLastPos(d))&&("undefined"!==
typeof b.i&&b.i===h||b===h))return g=!0,c.Directions[d+"End"].apply(c,f),!1}),!g&&(!a.parentTplName&&!a.protoStart)&&a.save("};"));this.forEach(a.sysPosCache,function(b,d){if((b=a.getLastPos(d))&&("undefined"!==typeof b.i&&b.i===h||b===h))return c.Directions[d+"End"].apply(c,f),!1})};s&&(module.exports=Snakeskin)})("undefined"===typeof window);
