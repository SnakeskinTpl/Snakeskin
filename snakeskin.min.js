var Snakeskin={VERSION:"1.0.1",Filters:{},cache:{}},SS=Snakeskin;
(function(y){var r;Array.isArray||(Array.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)});Snakeskin.forEach=function(b,c){var d=-1,a,g;if(Array.isArray(b))for(a=b.length;++d<a;)c(b[d],d,0===d,d===a-1,a);else{d=0;for(g in b)b.hasOwnProperty(g)&&d++;a=d;d=-1;for(g in b)b.hasOwnProperty(g)&&(d++,c(b[g],g,d,0===d,d===a-1,a))}};var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},Q=/[&<>"'\/]/g,R=function(b){return P[b]};Snakeskin.Filters.html=
function(b){return String(b).replace(Q,R)};Array.prototype.forEach||(Array.prototype.forEach=function(b,c){var d=-1,a=this.length;if(c)for(;(d+=1)<a;)b.call(c,this[d],d,this);else for(;(d+=1)<a;)b(this[d],d,this)});Array.prototype.some||(Array.prototype.some=function(b,c){var d=-1,a=this.length,g;if(c)for(;(d+=1)<a;){if(g=b.call(c,this[d],d,this))return!0}else for(;(d+=1)<a;)if(g=b(this[d],d,this))return!0;return!1});Array.prototype.reduce||(Array.prototype.reduce=function(b,c){var d=0,a=this.length,
g;if(1===a)return this[0];for(g="undefined"!==typeof c?c:this[0];(d+=1)<a;)g=b(g,this[d],d,this);return g});String.prototype.trim||(String.prototype.trim=function(){for(var b=this.replace(/^\s\s*/,""),c=b.length;/\s/.test(b.charAt(c-=1)););return b.substring(0,c+1)});var E={},z={},u={},x={},J={},v={},w={},K=[],S={'"':!0,"'":!0};Snakeskin._getExtStr=function(b){if(!E[w[b]])throw Error('The specified pattern ("'+w[b]+'" for "'+b+'") for inheritance is not defined!');for(var c=E[w[b]],d,a,g,f,h,e,j=
-1,k;6>++j;)for(e in 0===j%2&&(d=c.length),0===j?(g=z[b],f=z[w[b]]):2===j?(g=x[b],f=x[w[b]],k=0):4===j&&(g=u[b],f=u[w[b]],k=0),g)g.hasOwnProperty(e)&&(a=c.length-d,h=E[b].substring(g[e].from,g[e].to),f[e]&&0===j%2?(1<j&&(k=f[e].from+a+h.length+1),4===j&&console.log(c.substring(0,f[e].from+a),c.substring(f[e].to+a,c.length)),c=c.substring(0,f[e].from+a)+h+c.substring(f[e].to+a,c.length)):f[e]||(1===j?c+="{"+e+"}"+h+"{end}":3===j?(h="{"+h+"}",c=c.substring(0,k)+h+c.substring(k,c.length),k+=h.length):
5===j&&(h="{"+e+"}"+h+"{end}",c=c.substring(0,k)+h+c.substring(k,c.length),k+=h.length)));console.log(c);return c};Snakeskin._escape=function(b){var c;b=b.split("");b.forEach(function(d,a){if(S[d]){if(!b[a-1]||"\\"!==b[a-1])c=c&&c===d?!1:d}else if(c)switch(d){case "|":b[a]="__SNAKESKIN_ESCAPE__PIPE";break;case "=":b[a]="__SNAKESKIN_ESCAPE__EQUAL";break;case ",":b[a]="__SNAKESKIN_ESCAPE__COMMA";break;case "(":b[a]="__SNAKESKIN_ESCAPE__BOPEN";break;case ")":b[a]="__SNAKESKIN_ESCAPE__BCLOSE"}});return b=
b.join("")};Snakeskin._descape=function(b){return b.replace(/__SNAKESKIN_ESCAPE__PIPE/g,"|").replace(/__SNAKESKIN_ESCAPE__EQUAL/g,"=").replace(/__SNAKESKIN_ESCAPE__COMMA/g,",").replace(/__SNAKESKIN_ESCAPE__BOPEN/g,"(").replace(/__SNAKESKIN_ESCAPE__BCLOSE/g,")")};Snakeskin.compile=function(b,c){var d=(b.innerHTML||b).replace(/{cdata}([\s\S]*?){end\s+cdata}/,function(a,b){K.push(b);return"@cdata_"+(K.length-1)}).replace(/\/\/.*/g,"").replace(/^\s*|\s*$/g,"").replace(/{end}\s*{template/g,"{end}{template").replace(/[\t]/g,
"").replace(/[\n\r]/g,"").replace(/\/\*[\s\S]*?\*\//g,""),a="/* This code is generated automatically, don't alter it. */"+(c?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);return this;};":""),g,f,h,e,j,k,A,r=0,l=0,B,F=[],G,H,m,L,M,s="",t=[],C,D=[],N;e="";for(var I,p,O,n=-1,q;++n<d.length;){g=d.charAt(n);if("{"===g)if(A)r++;else{A=!0;m&&(L=!0);continue}else if("}"===g&&(!r||!r--)){A=!1;e=this._escape(e);m&&(M=!0);switch(e.split(" ")[0]){case "template":l++;
f=e.replace(/^template\s+/,"").replace(/\(.*/,"");/\s+extends\s+/.test(e)&&(h=e.replace(/.*?\s+extends\s+(.*)/,"$1"));j=e.replace(/.*?\((.*?)\).*/,"$1");z[f]={};u[f]={};x[f]={};J[f]={};w[f]=h;a+="/* Snakeskin template: "+f+"; "+j.replace(/=(.*?)(?:,|$)/g,"")+" */";/\./.test(f)||c?(f.split(".").reduce(function(b,d,e){a+="if (typeof "+(c?"exports.":"")+b+" === 'undefined') { "+(c?"exports.":1===e?y?"var ":"window.":"")+b+" = {}; }";return b+"."+d}),a+=(c?"exports.":"")+f+"= function ("):a+=(!y?"window."+
f+" = ":"")+"function "+(y?f:"")+"(";q=n+1;j=j.split(",");v[f]=v[h]?v[h].concat(j):j;k="";v[h]&&v[h].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();j.forEach(function(d,e){var c=d.split("=");c[0]=c[0].trim();c[1]=c[1]&&c[1].trim();b[0]===c[0]&&"undefined"===typeof c[1]&&(j[e]=a)})});j.forEach(function(b,d){var c=b.split("=");c[0]=c[0].trim();a+=c[0];1<c.length&&(v[h]&&!k&&v[h].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();j.some(function(a){a=
a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]})||(k="undefined"!==typeof b[1]?k+("var "+b[0]+" = typeof "+b[0]+" !== 'undefined' && "+b[0]+" !== null ? "+b[0]+" : "+b[1]+";"):k+("var "+b[0]+";"))}),c[1]=c[1].trim(),J[f][c[0]]=b,k+=c[0]+" = typeof "+c[0]+" !== 'undefined' && "+c[0]+" !== null ? "+c[0]+" : "+c[1]+";");d!==j.length-1&&(a+=",")});a+=") { "+k+"var __RESULT__ = '', __TMP_RESULT__;";break;case "if":l++;!h&&!m&&(a+="if ("+e.replace(/^\/?if\s+/,"")+") {");break;case "elseIf":!h&&
!m&&(a+="} else if ("+e.replace(/^elseIf\s+/,"")+") {");break;case "else":!h&&!m&&(a+="} else {");break;case "with":t.push({scope:e.replace(/^with\s+/,""),i:++l});break;case "proto":u[f][e]={from:n-q+1};G=e;H=++l;h||(m=!0);break;case "apply":d=d.substring(0,n+1)+u[f][e.replace(/^apply/,"proto")].body+d.substring(n+1,d.length);break;case "block":z[f][e]={from:n-q+1};F.push({name:e,i:++l});break;case "forEach":D.push(++l);!h&&!m&&(e=e.replace(/^forEach\s+/,"").split("=>"),a+=e[0]+" && Snakeskin.forEach("+
e[0]+", function ("+(e[1]||"")+") {");break;case "end":l--;g=F[F.length-1];C=t[t.length-1];N=D[D.length-1];if(0===l){E[f]=d.substring(q,n-e.length-1);if(h){d=d.substring(0,q)+this._getExtStr(f)+d.substring(n-e.length-1,d.length);x[f]={};n=q-1;l++;B=A=h=!1;e="";continue}a+="return __RESULT__; }; Snakeskin.cache['"+f+"'] = "+(c?"exports.":"")+f+";"}else if(!h&&H!==l+1&&(!g||g.i!==l+1)&&(!C||C.i!==l+1))N===l+1?(D.pop(),m||(a+="});")):m||(a+="};");g&&g.i===l+1&&(z[f][g.name].to=n-q-e.length-1,F.pop());
H===l+1&&(u[f][G].to=n-q-e.length-1,u[f][G].body=s.replace(/{end$/,""),H=G=void 0,s="",m=!1);C&&C.i===l+1&&t.pop();break;default:if(!h&&!m&&/console\./.test(e)){a+=e+";";break}if(/=(?!=)/.test(e)){p=e.split("=")[0].trim();if(x[f][p]||J[f][p]||"__RESULT__"===p)throw Error('Variable "'+p+'" has already defined (template: "'+f+'")!');if(D.length)throw Error('Variable "'+p+'" can\'t be defined in a loop (template: "'+f+'")!');x[f][p]={from:n-q-e.length,to:n-q};!h&&!m&&(a+="var "+e+";")}else!h&&!m&&(p=
"",O=1,I=!1,e.split("|").forEach(function(a,b){var c,d;0===b?t.length?(t.push({scope:a}),p=t.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),t.pop()):p=a:(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(O++,p="Snakeskin.Filters['"+c[0]+"']("+p+(d.length?", "+d.join(""):"")+")"):I=!0)}),a+="__TMP_RESULT__ = "+(!I?"Snakeskin.Filters.html(":"")+p+(!I?")":"")+";",a+="__RESULT__ += typeof __TMP_RESULT__ === 'undefined' ? '' : __TMP_RESULT__;")}e="";continue}A?(!m&&B&&(a+=
"';",B=!1),e+=g):m||(B||(a+="__RESULT__ += '",B=!0),!h&&!m&&(a+=g));m&&(M&&(s+="}",M=!1),L&&(s+="{",L=!1),s+=g)}a=this._descape(a).replace(/@cdata_(\d+)/g,function(a,b){return K[b].replace(/[\n\r]/g,"").replace(/\'/g,"&#39;")}).replace(/__RESULT__ \+= '';/g,"");a+="/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */";console.log(a);if(0!==l)throw Error("Missing closing or opening tag in the template!");y?c?eval(a):global.eval(a):window.eval(a);return a};if(y)for(r in Snakeskin)Snakeskin.hasOwnProperty(r)&&
(exports[r]=Snakeskin[r])})("undefined"===typeof window);
