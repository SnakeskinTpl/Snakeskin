var Snakeskin={VERSION:"1.3.2",Filters:{},Vars:{BEMtag:{}},cache:{}},SS=Snakeskin;
(function(J){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});String.prototype.trim||(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),f=a.length;/\s/.test(a.charAt(--f)););return a.substring(0,f+1)});Snakeskin.forEach=function(a,f){var c=-1,h,b;if(Array.isArray(a))for(h=a.length;++c<h;)f(a[c],c,0===c,c===h-1,h);else{c=0;for(b in a)a.hasOwnProperty(b)&&c++;h=c;c=-1;for(b in a)a.hasOwnProperty(b)&&(c++,f(a[b],b,c,0===c,c===h-
1,h))}};var Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},$=/[&<>"'\/]/g,aa=function(a){return Z[a]};Snakeskin.Filters.html=function(a){return String(a).replace($,aa)};Snakeskin.Filters.undef=function(a){return"undefined"!==typeof a?a:""};var ba={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},ca=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g,da=function(a){return ba[a]};Snakeskin.Filters.uhtml=function(a){return String(a).replace(ca,da)};var ea=/<\/?[^>]+>/g;
Snakeskin.Filters.stripTags=function(a){return String(a).replace(ea,"")};var fa=/%5B/g,ga=/%5D/g;Snakeskin.Filters.uri=function(){return encodeURI(String(url)).replace(fa,"[").replace(ga,"]")};Snakeskin.Filters.upper=function(a){return String(a).toUpperCase()};Snakeskin.Filters.ucfirst=function(a){a=String(a);return a.charAt(0).toUpperCase()+a.substring(1)};Snakeskin.Filters.lower=function(a){return String(a).toLowerCase()};Snakeskin.Filters.lcfirst=function(a){a=String(a);return a.charAt(0).toLowerCase()+
a.substring(1)};Snakeskin.Filters.trim=function(a){return String(a).trim()};var ha=/\s{2,}/g;Snakeskin.Filters.collapse=function(a){return String(a).replace(ha," ").trim()};Snakeskin.Filters.truncate=function(a,f,c){a=String(a);if(!a||a.length<=f)return a;a=a.substring(0,f-1);var h;for(f=a.length;f--&&c;)if(" "===a.charAt(f))h=f;else if("undefined"!==typeof h)break;return("undefined"!==typeof h?a.substring(0,h):a)+"\u2026"};Snakeskin.Filters.repeat=function(a,f){return Array(f||2).join(a)};Snakeskin.Filters.remove=
function(a,f){return String(a).replace(f,"")};Snakeskin.Filters.replace=function(a,f,c){return String(a).replace(f,c)};Array.prototype.forEach||(Array.prototype.forEach=function(a,f){var c=-1,h=this.length;if(f)for(;++c<h;)a.call(f,this[c],c,this);else for(;++c<h;)a(this[c],c,this)});Array.prototype.some||(Array.prototype.some=function(a,f){var c=-1,h=this.length,b;if(f)for(;++c<h;){if(b=a.call(f,this[c],c,this))return!0}else for(;++c<h;)if(b=a(this[c],c,this))return!0;return!1});Array.prototype.reduce||
(Array.prototype.reduce=function(a,f){var c=0,h=this.length,b;if(1===h)return this[0];for(b="undefined"!==typeof f?f:this[0];++c<h;)b=a(b,this[c],c,this);return b});var K={},E={},w={},O={},U={},F={},P={},L={},x={},Q={},S=[],ia={'"':!0,"'":!0},ja={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_CDATA__:!0},k;Snakeskin._escape=function(a,f){return a.replace(/(["']).*?[^\\]\1/g,function(a){f&&f.push(a);return"__SNAKESKIN_QUOT__"+(f?f.length-1:"_")})};Snakeskin._uescape=function(a,f){return a.replace(/__SNAKESKIN_QUOT__(\d+)/g,
function(a,h){return f[h]})};Snakeskin._getExtStr=function(a,f){if("undefined"===typeof K[Q[a]])throw k=Error('The specified pattern ("'+Q[a]+'" for "'+a+'") for inheritance is not defined ('+this._genError(f)+")!"),k.name="Snakeskin Error",k;for(var c=Q[a],h=K[c],b,j,e,g,m=-1,r,n=0,x=[],l,z,s;6>++m;)for(g in 0===m?(b=E[a],j=E[c]):2===m?(b=F[a],j=F[c],n=P[c],r=null):4===m&&(b=w[a],j=w[c],n=O[c],r=null),b)if(b.hasOwnProperty(g))if(s=0,e=K[a].substring(b[g].from,b[g].to),j[g]&&(l=e.length-K[c].substring(j[g].from,
j[g].to).length),z=j[g]?j[g].from:n,x.sort(function(a,b){if(a.val>b.val)return 1;if(a.val===b.val)return 0;if(a.val<b.val)return-1}).some(function(a){if(a.val<z)s+=a.adv;else return!0}),j[g]&&0===m%2)1<m&&(r=j[g].from+s+e.length,n+=l,r>n&&(n=r+(4===m?5:1))),h=h.substring(0,j[g].from+s)+e+h.substring(j[g].to+s),x.push({val:j[g].from,adv:l});else if(!j[g])if(1===m)h+="{"+g+"}"+e+"{end}";else if(3===m||5===m)null===r&&(r=n,n+=s),e=3===m?"{"+e+"}":"{"+g+"}"+e+"{end}",h=h.substring(0,n)+e+h.substring(n),
x.push({val:r,adv:e.length}),n+=e.length;return h};Snakeskin._genError=function(a){var f,c="";for(f in a)a.hasOwnProperty(f)&&(c=a[f].innerHTML?c+(f+": (class: "+(a[f].className||"undefined")+", id: "+(a[f].id||"undefined")+"), "):c+(f+": "+a[f]+", "));return c.replace(/, $/,"")};Snakeskin.compile=function(a,f,c,h){h=h||{};a.innerHTML&&(h.node=a);a=String(a.innerHTML||a).replace(/{cdata}([\s\S]*?){end\s+cdata}/gm,function(a,b){S.push(b);return"__SNAKESKIN_CDATA__"+(S.length-1)}).replace(/\/\/.*/gm,
"").replace(/[\t\v\r\n]/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").trim();for(var b=""+(!c?"/* This code is generated automatically, don't alter it. */":"")+(f?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":""),j,e=null,g,m,r,n,D=0,l=0,z,s=[],A,y=[],u,t,T=0,V,B={},C=[],M,N=[],W,G=[],X={},d="",R,p,Y,H=[],q=-1,v,I;++q<a.length;){j=a.charAt(q);if(!I)if("{"===j)if(n)D++;else{n=!0;continue}else if("}"===j&&(!D||!D--)){n=
!1;d=this._escape(d,H).trim();switch(d.split(" ")[0]){case "template":if(0!==l)throw k=Error("Missing closing or opening tag in the template (command: {"+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;l++;v=q+1;e=j=/^template\s+(.*?)\(/.exec(d)[1];e=this._uescape(e,H);if(c)break;/\s+extends\s+/.test(d)&&(g=this._uescape(/\s+extends\s+(.*)/.exec(d)[1],H));m=d.replace(/.*?\((.*?)\).*/,"$1");E[e]={};w[e]={};O[e]=0;F[e]={};P[e]=0;L[e]={};Q[e]=g;b+="/* Snakeskin template: "+
e+"; "+m.replace(/=(.*?)(?:,|$)/g,"")+" */";/\.|\[/.test(j)||f?(j.replace(/\[/g,".").replace(/]/g,"").split(".").reduce(function(a,d,e){X[a]||(b+="if (typeof "+(f?"exports.":"")+a+" === 'undefined') { "+(f?"exports.":1===e?J?"var ":"window.":"")+a+" = {}; }",X[a]=!0);return"__SNAKESKIN_QUOT__"===d.substring(0,18)?a+"["+d+"]":a+"."+d}),b+=(f?"exports.":"")+j+"= function ("):b+=(!J?"window."+j+" = ":"")+"function "+(J?j:"")+"(";m=m.split(",");x[e]=x[g]?x[g].concat(m):m;r="";x[g]&&x[g].forEach(function(a){var b=
a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();m.forEach(function(d,e){var c=d.split("=");c[0]=c[0].trim();c[1]=c[1]&&c[1].trim();b[0]===c[0]&&"undefined"===typeof c[1]&&(m[e]=a)})});m.forEach(function(a,d){var c=a.split("=");c[0]=c[0].trim();b+=c[0];1<c.length&&(x[g]&&!r&&x[g].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();!m.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]})&&"undefined"!==typeof b[1]&&(r+="var "+b[0]+
" = "+b[1]+";",L[e][b[0]]=a)}),c[1]=c[1].trim(),r+=c[0]+" = typeof "+c[0]+" !== 'undefined' && "+c[0]+" !== null ? "+c[0]+" : "+c[1]+";");L[e][c[0]]=a;d!==m.length-1&&(b+=",")});b+=") { "+r+"var __SNAKESKIN_RESULT__ = '';";break;case "if":l++;!g&&!t&&(b+="if ("+d.replace(/^if\s+/,"")+") {");break;case "elseIf":!g&&!t&&(b+="} else if ("+d.replace(/^elseIf\s+/,"")+") {");break;case "else":!g&&!t&&(b+="} else {");break;case "with":C.push({scope:d.replace(/^with\s+/,""),i:++l});break;case "proto":if(!c&&
(g&&!s.length&&!y.length||!g)){if(w[e][d])throw k=Error('Proto "'+d.replace(/^proto\s+/,"")+'" is already defined (command: {'+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;w[e][d]={from:q-v+1}}y.push({name:d,i:++l,startI:q+1});g||(t=!0);break;case "apply":!g&&!y.length&&(d=d.replace(/^apply/,"proto"),w[e][d]?b+=w[e][d].body:(B[d]||(B[d]=[],B[d].protoStart=t,V=d.replace(/^proto\s+/,""),T++),B[d].push(b.length)));break;case "block":if(!c&&(g&&!s.length&&!y.length||!g)){if(E[e][d])throw k=
Error('Block "'+d.replace(/^block\s+/,"")+'" is already defined (command: {'+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;E[e][d]={from:q-v+1}}s.push({name:d,i:++l});break;case "forEach":N.push(++l);!g&&!t&&(d=d.replace(/^forEach\s+/,"").split("=>"),b+=d[0]+" && Snakeskin.forEach("+d[0]+", function ("+(d[1]||"")+") {");break;case "bem":G.push({i:++l,tag:/\(/g.test(d)?/\(.*?\)/.exec(d)[1]:null});j=G[G.length-1];d=j.tag?d.replace(/^.*?\)([\s\S]*)/,"$1"):d.substring(3);
d=d.trim().split(",");A=d[0];j.original=this.Vars.BEMtag[A];!g&&!t&&(d[0]+="'",d=d.join(","),b+="__SNAKESKIN_RESULT__ += '<"+(j.tag||j.original||"div")+' class="i-bem" data-params="{name: \\\''+this._uescape(d,H).replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")+"}\">';");break;case "end":l--;A=s[s.length-1];u=y[y.length-1];M=C[C.length-1];W=N[N.length-1];j=G[G.length-1];if(0===l){if(T)throw k=Error('Proto "'+V+'" is not defined (command: {'+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name=
"Snakeskin Error",k;if(c)break;K[e]=a.substring(v,q-d.length-1);if(g){a=a.substring(0,v)+this._getExtStr(e,h)+a.substring(q-d.length-1);E[e]={};w[e]={};O[e]=0;F[e]={};P[e]=0;L[e]={};q=v-1;l++;z=n=g=!1;d="";continue}b+="return __SNAKESKIN_RESULT__; };if (typeof Snakeskin !== 'undefined') {Snakeskin.cache['"+this._uescape(e,H).replace(/'/g,"\\'")+"'] = "+(f?"exports.":"")+e+";}";e=null}else if(!g&&(!u||u.i!==l+1)&&(!A||A.i!==l+1)&&(!M||M.i!==l+1))W===l+1?(N.pop(),t||(b+="});")):j&&j.i===l+1?(G.pop(),
t||(b+="__SNAKESKIN_RESULT__ += '</"+(j.tag||j.original||"div")+">';")):t||(b+="};");if(A&&A.i===l+1&&(s.pop(),!c&&(g&&!s.length&&!y.length||!g)))E[e][A.name].to=q-v-d.length-1;if(u&&u.i===l+1){y.pop();if(!c&&(g&&!s.length&&!y.length||!g))w[e][u.name].to=q-v-d.length-1,O[e]=q-v+1;g||(w[e][u.name].body=this.compile("{template "+e+"()}"+a.substring(u.startI,q-d.length-1)+"{end}",null,!0));B[u.name]&&!B[u.name].protoStart&&(B[u.name].forEach(function(a){b=b.substring(0,a)+w[e][u.name].body+b.substring(a)}),
delete B[u.name],T--);y.length||(t=!1)}M&&M.i===l+1&&C.pop();break;default:if(!g&&!t&&/console\./.test(d)){b+=d+";";break}if(/=(?!=)/.test(d))if(p=d.split("=")[0].trim(),e){if(F[e][p]||L[e][p])throw k=Error('Variable "'+p+'" is already defined (command: {'+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;if(ja[p])throw k=Error("Can't declare variable \""+p+'", try another name (command: {'+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;if(N.length)throw k=
Error('Variable "'+p+"\" can't be defined in a loop (command: {"+d+'}, template: "'+e+", "+this._genError(h)+'")!'),k.name="Snakeskin Error",k;F[e][p]={from:q-v-d.length,to:q-v};P[e]=q-v+1;!g&&!t&&(b+="var "+d+";")}else U[p]=!0,b+="Snakeskin.Vars."+d+";";else!g&&!t&&(p="",Y=1,R=!1,d.replace(/\|\|/g,"__SNAKESKIN_ESCAPE__OR").split("|").forEach(function(a,b){var c,d;0===b?(C.length?(C.push({scope:a}),p=C.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),C.pop()):p=a,
p="Snakeskin.Filters.undef("+(!F[e][p]&&U[p]?"Snakeskin.Vars.":"")+p+")"):(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(Y++,p="Snakeskin.Filters['"+c[0]+"']("+p+(d.length?", "+d.join(""):"")+")"):R=!0)}),b+="__SNAKESKIN_RESULT__ += "+(!R?"Snakeskin.Filters.html(":"")+p+(!R?")":"")+";")}d="";continue}if(n){!t&&z&&(b+="';",z=!1);if((ia[j]||"/"===j)&&(!a[q-1]||"\\"!==a[q-1]))I&&I===j?I=!1:I||(I=j);d+=j}else t||(z||(b+="__SNAKESKIN_RESULT__ += '",z=!0),g||(b+=j))}b=this._uescape(b,H).replace(/__SNAKESKIN_ESCAPE__OR/g,
"||").replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return S[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/\'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");b+=!c?"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */":"";b+=f?"}":"";if(0!==l)throw k=Error("Missing closing or opening tag in the template (template: "+e+", "+this._genError(h)+")!"),k.name="Snakeskin Error",k;if(c)return b;J?f?eval(b):global.eval(b):window.eval(b);
return b};var D;if(J)for(D in Snakeskin)Snakeskin.hasOwnProperty(D)&&(exports[D]=Snakeskin[D])})("undefined"===typeof window);
