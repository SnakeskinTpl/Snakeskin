var Snakeskin={VERSION:"1.5.3",Filters:{},BEM:{},Vars:{},write:{},cache:{}},SS=Snakeskin;
(function(L){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});String.prototype.trim||(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),f=a.length;/\s/.test(a.charAt(--f)););return a.substring(0,f+1)});Snakeskin.forEach=function(a,f){var d=-1,g,j;if(Array.isArray(a))for(g=a.length;++d<g;)f(a[d],d,0===d,d===g-1,g);else{d=0;for(j in a)a.hasOwnProperty(j)&&d++;g=d;d=-1;for(j in a)a.hasOwnProperty(j)&&(d++,f(a[j],j,d,0===d,d===g-
1,g))}};var ba={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ca=/[&<>"'\/]/g,da=function(a){return ba[a]};Snakeskin.Filters.html=function(a){return String(a).replace(ca,da)};Snakeskin.Filters.undef=function(a){return"undefined"!==typeof a?a:""};var ea={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},fa=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g,ga=function(a){return ea[a]};Snakeskin.Filters.uhtml=function(a){return String(a).replace(fa,ga)};var ha=
/<\/?[^>]+>/g;Snakeskin.Filters.stripTags=function(a){return String(a).replace(ha,"")};var ia=/%5B/g,ja=/%5D/g;Snakeskin.Filters.uri=function(a){return encodeURI(String(a)).replace(ia,"[").replace(ja,"]")};Snakeskin.Filters.upper=function(a){return String(a).toUpperCase()};Snakeskin.Filters.ucfirst=function(a){a=String(a);return a.charAt(0).toUpperCase()+a.substring(1)};Snakeskin.Filters.lower=function(a){return String(a).toLowerCase()};Snakeskin.Filters.lcfirst=function(a){a=String(a);return a.charAt(0).toLowerCase()+
a.substring(1)};Snakeskin.Filters.trim=function(a){return String(a).trim()};var ka=/\s{2,}/g;Snakeskin.Filters.collapse=function(a){return String(a).replace(ka," ").trim()};Snakeskin.Filters.truncate=function(a,f,d){a=String(a);if(!a||a.length<=f)return a;a=a.substring(0,f-1);var g;for(f=a.length;f--&&d;)if(" "===a.charAt(f))g=f;else if("undefined"!==typeof g)break;return("undefined"!==typeof g?a.substring(0,g):a)+"\u2026"};Snakeskin.Filters.repeat=function(a,f){return Array(f||2).join(a)};Snakeskin.Filters.remove=
function(a,f){return String(a).replace(f,"")};Snakeskin.Filters.replace=function(a,f,d){return String(a).replace(f,d)};Array.prototype.forEach||(Array.prototype.forEach=function(a,f){var d=-1,g=this.length;if(f)for(;++d<g;)a.call(f,this[d],d,this);else for(;++d<g;)a(this[d],d,this)});Array.prototype.some||(Array.prototype.some=function(a,f){var d=-1,g=this.length,j;if(f)for(;++d<g;){if(j=a.call(f,this[d],d,this))return!0}else for(;++d<g;)if(j=a(this[d],d,this))return!0;return!1});Array.prototype.reduce||
(Array.prototype.reduce=function(a,f){var d=0,g=this.length,j;if(1===g)return this[0];for(j="undefined"!==typeof f?f:this[0];++d<g;)j=a(j,this[d],d,this);return j});var M={},G={},v={},R={},Y={},H={},S={},N={},y={},T={},V=[],la={'"':!0,"'":!0},ma={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_CDATA__:!0},j;Snakeskin._escape=function(a,f){return a.replace(/(["']).*?[^\\]\1/g,function(a){f&&f.push(a);return"__SNAKESKIN_QUOT__"+(f?f.length-1:"_")})};Snakeskin._uescape=function(a,f){return a.replace(/__SNAKESKIN_QUOT__(\d+)/g,
function(a,g){return f[g]})};Snakeskin._getExtStr=function(a,f){if("undefined"===typeof M[T[a]])throw j=Error('The specified pattern ("'+T[a]+'" for "'+a+'") for inheritance is not defined ('+this._genError(f)+")!"),j.name="Snakeskin Error",j;for(var d=T[a],g=M[d],u,b,l,h,e=-1,k,n=0,w=[],A,y,m;6>++e;)for(h in 0===e?(u=G[a],b=G[d]):2===e?(u=H[a],b=H[d],n=S[d],k=null):4===e&&(u=v[a],b=v[d],n=R[d],k=null),u)if(u.hasOwnProperty(h))if(m=0,l=M[a].substring(u[h].from,u[h].to),b[h]&&(A=l.length-M[d].substring(b[h].from,
b[h].to).length),y=b[h]?b[h].from:n,w.sort(function(a,b){if(a.val>b.val)return 1;if(a.val===b.val)return 0;if(a.val<b.val)return-1}).some(function(a){if(a.val<y)m+=a.adv;else return!0}),b[h]&&0===e%2)1<e&&(k=b[h].from+m+l.length,n+=A,k>n&&(n=k+(4===e?5:1))),g=g.substring(0,b[h].from+m)+l+g.substring(b[h].to+m),w.push({val:b[h].from,adv:A});else if(!b[h])if(1===e)g+="{"+h+"}"+l+"{end}";else if(3===e||5===e)null===k&&(k=n,n+=m),l=3===e?"{"+l+"}":"{"+h+"}"+l+"{end}",g=g.substring(0,n)+l+g.substring(n),
w.push({val:k,adv:l.length}),n+=l.length;return g};Snakeskin._genError=function(a){var f,d="";for(f in a)a.hasOwnProperty(f)&&(d=a[f].innerHTML?d+(f+": (class: "+(a[f].className||"undefined")+", id: "+(a[f].id||"undefined")+"), "):d+(f+": "+a[f]+", "));return d.replace(/, $/,"")};Snakeskin.compile=function(a,f,d,g){g=g||{};a.innerHTML&&(g.node=a);var u=this;a=String(a.innerHTML||a).replace(/{cdata}([\s\S]*?){end\s+cdata}/gm,function(a,b){V.push(b);return"__SNAKESKIN_CDATA__"+(V.length-1)}).replace(/\/\/.*/gm,
"").replace(/[\t\v\r\n]/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").trim();for(var b=""+(!d?"/* This code is generated automatically, don't alter it. */":"")+(f?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":""),l,h,e=null,k,n,w,A,F=0,m=0,O,C=[],B,z=[],s,r,W=0,Z,D={},E=[],P,Q=[],X,J=[],$={},I,c="",U,p,aa,x=[],q=-1,t,K;++q<a.length;){l=a.charAt(q);if(!K)if("{"===l)if(A)F++;else{A=!0;continue}else if("}"===l&&(!F||
!F--)){A=!1;I=c.length;c=this._escape(c,x).trim();switch(c.split(" ")[0]){case "template":if(0!==m)throw j=Error("Missing closing or opening tag in the template (command: {"+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;m++;t=q+1;e=l=/^template\s+(.*?)\(/.exec(c)[1];e=this._uescape(e,x);h=!1!==this.write[e];if(d)break;/\s+extends\s+/.test(c)&&(k=this._uescape(/\s+extends\s+(.*)/.exec(c)[1],x));n=c.replace(/.*?\((.*?)\).*/,"$1");G[e]={};v[e]={};R[e]=0;H[e]={};S[e]=0;
N[e]={};T[e]=k;h&&(b+="/* Snakeskin template: "+e+"; "+n.replace(/=(.*?)(?:,|$)/g,"")+" */");/\.|\[/.test(l)||f?(l.replace(/\[/g,".").replace(/]/g,"").split(".").reduce(function(a,c,e){$[a]||(h&&(b+="if (typeof "+(f?"exports.":"")+a+" === 'undefined') { "+(f?"exports.":1===e?L?"var ":"window.":"")+a+" = {}; }"),$[a]=!0);return"__SNAKESKIN_QUOT__"===c.substring(0,18)?a+"["+c+"]":a+"."+c}),h&&(b+=(f?"exports.":"")+l+"= function (")):h&&(b+=(!L?"window."+l+" = ":"")+"function "+(L?l:"")+"(");n=n.split(",");
y[e]=y[k]?y[k].concat(n):n;w="";y[k]&&y[k].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();n.forEach(function(c,e){var d=c.split("=");d[0]=d[0].trim();d[1]=d[1]&&d[1].trim();b[0]===d[0]&&"undefined"===typeof d[1]&&(n[e]=a)})});n.forEach(function(a,c){var d=a.split("=");d[0]=d[0].trim();h&&(b+=d[0]);1<d.length&&(y[k]&&!w&&y[k].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();!n.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&
a[1].trim();return a[0]===b[0]})&&"undefined"!==typeof b[1]&&(w+="var "+b[0]+" = "+b[1]+";",N[e][b[0]]=a)}),d[1]=d[1].trim(),w+=d[0]+" = typeof "+d[0]+" !== 'undefined' && "+d[0]+" !== null ? "+d[0]+" : "+d[1]+";");N[e][d[0]]=a;c!==n.length-1&&h&&(b+=",")});h&&(b+=") { "+w+"var __SNAKESKIN_RESULT__ = '';");break;case "cut":c=this._uescape(c.replace(/^cut\s+/,""),x);this.write[c]||(this.write[c]=!1);break;case "save":this.write[this._uescape(c.replace(/^save\s+/,""),x)]=!0;break;case "if":m++;!k&&
!r&&h&&(b+="if ("+c.replace(/^if\s+/,"")+") {");break;case "elseIf":!k&&!r&&h&&(b+="} else if ("+c.replace(/^elseIf\s+/,"")+") {");break;case "else":!k&&!r&&h&&(b+="} else {");break;case "with":E.push({scope:c.replace(/^with\s+/,""),i:++m});break;case "proto":if(!d&&(k&&!C.length&&!z.length||!k)){if(v[e][c])throw j=Error('Proto "'+c.replace(/^proto\s+/,"")+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;v[e][c]={from:q-t+1}}z.push({name:c,
i:++m,startI:q+1});k||(r=!0);break;case "apply":!k&&!z.length&&(c=c.replace(/^apply/,"proto"),v[e][c]?h&&(b+=v[e][c].body):(D[c]||(D[c]=[],D[c].protoStart=r,Z=c.replace(/^proto\s+/,""),W++),D[c].push(b.length)));break;case "block":if(!d&&(k&&!C.length&&!z.length||!k)){if(G[e][c])throw j=Error('Block "'+c.replace(/^block\s+/,"")+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;G[e][c]={from:q-t+1}}C.push({name:c,i:++m});break;case "forEach":Q.push(++m);
!k&&!r&&(c=c.replace(/^forEach\s+/,"").split("=>"),h&&(b+=c[0]+" && Snakeskin.forEach("+c[0]+", function ("+(c[1]||"")+") {"));break;case "setBEM":c=c.replace(/^setBEM\s+/,"").match(/(.*?)\s+(.*)/);this.BEM[c[1]]=(new Function("return "+this._uescape(c[2],x)))();break;case "bem":J.push({i:++m,tag:/\(/g.test(c)?/\((.*?)\)/.exec(c)[1]:null});l=J[J.length-1];c=l.tag?c.replace(/^.*?\)([\s\S]*)/,"$1"):c.substring(3);c=c.trim().split(",");B=c[0];l.original=this.BEM[B]&&this.BEM[B].tag;!k&&!r&&(c[0]+="'",
c=c.join(","),c=c.split("${"),c=1<c.length?c.reduce(function(a,b,c){return 1===c?u._uescape(a,x).replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1")+"\\'' + Snakeskin.Filters.html(Snakeskin.Filters.undef("+b.replace("}",")) + '\\'"):c%2?a+u._uescape(b,x).replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1"):a+"\\'' + Snakeskin.Filters.html(Snakeskin.Filters.undef("+b.replace("}",")) + '\\'")}):u._uescape(c[0],x).replace(/\\/g,"\\\\").replace(/('|")/g,"\\$1"),h&&(b+="__SNAKESKIN_RESULT__ += '<"+(l.tag||l.original||
"div")+' class="i-bem" data-params="{name: \\\''+c+"}\">';"));break;case "end":m--;B=C[C.length-1];s=z[z.length-1];P=E[E.length-1];X=Q[Q.length-1];l=J[J.length-1];if(0===m){if(W)throw j=Error('Proto "'+Z+'" is not defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;if(d)break;M[e]=a.substring(t,q-I-1);if(k){a=a.substring(0,t)+this._getExtStr(e,g)+a.substring(q-I-1);G[e]={};v[e]={};R[e]=0;H[e]={};S[e]=0;N[e]={};q=t-1;m++;!1===this.write[k]&&(b=b.replace(RegExp("/\\* Snakeskin template: "+
k.replace(/([.\[\]^$])/g,"\\$1")+";[\\s\\S]*?/\\* Snakeskin template\\. \\*/","m"),""));O=A=k=!1;c="";continue}h&&(b+="return __SNAKESKIN_RESULT__; };if (typeof Snakeskin !== 'undefined') {Snakeskin.cache['"+this._uescape(e,x).replace(/'/g,"\\'")+"'] = "+(f?"exports.":"")+e+";}/* Snakeskin template. */");h=!0;e=null}else if(!k&&(!s||s.i!==m+1)&&(!B||B.i!==m+1)&&(!P||P.i!==m+1))X===m+1?r||h&&(b+="});"):l&&l.i===m+1?r||h&&(b+="__SNAKESKIN_RESULT__ += '</"+(l.tag||l.original||"div")+">';"):r||h&&(b+=
"};");X===m+1&&Q.pop();l&&l.i===m+1&&J.pop();if(B&&B.i===m+1&&(C.pop(),!d&&(k&&!C.length&&!z.length||!k)))G[e][B.name].to=q-t-I-1;if(s&&s.i===m+1){z.pop();if(!d&&(k&&!C.length&&!z.length||!k))v[e][s.name].to=q-t-I-1,R[e]=q-t+1;k||(v[e][s.name].body=this.compile("{template "+e+"()}"+a.substring(s.startI,q-I-1)+"{end}",null,!0));D[s.name]&&!D[s.name].protoStart&&(D[s.name].forEach(function(a){h&&(b=b.substring(0,a)+v[e][s.name].body+b.substring(a))}),delete D[s.name],W--);z.length||(r=!1)}P&&P.i===
m+1&&E.pop();break;default:if(!k&&!r&&/console\./.test(c)){h&&(b+=c+";");break}if(/=(?!=)/.test(c))if(p=c.split("=")[0].trim(),e){if(H[e][p]||N[e][p])throw j=Error('Variable "'+p+'" is already defined (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;if(ma[p])throw j=Error("Can't declare variable \""+p+'", try another name (command: {'+c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;if(Q.length)throw j=Error('Variable "'+p+"\" can't be defined in a loop (command: {"+
c+'}, template: "'+e+", "+this._genError(g)+'")!'),j.name="Snakeskin Error",j;H[e][p]={from:q-t-I,to:q-t};S[e]=q-t+1;!k&&!r&&h&&(b+="var "+c+";")}else Y[p]=!0,h&&(b+="if (typeof Snakeskin !== 'undefined') { Snakeskin.Vars."+c+"; }");else!k&&!r&&(p="",aa=1,U=!1,c.replace(/\|\|/g,"__SNAKESKIN_ESCAPE__OR").split("|").forEach(function(a,b){var c,d;0===b?(E.length?(E.push({scope:a}),p=E.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),E.pop()):p=a,p="Snakeskin.Filters.undef("+
(!H[e][p]&&Y[p]?"Snakeskin.Vars.":"")+p+")"):(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(aa++,p="Snakeskin.Filters['"+c[0]+"']("+p+(d.length?", "+d.join(""):"")+")"):U=!0)}),h&&(b+="__SNAKESKIN_RESULT__ += "+(!U?"Snakeskin.Filters.html(":"")+p+(!U?")":"")+";"))}c="";continue}if(A){!r&&O&&(h&&(b+="';"),O=!1);if((la[l]||"/"===l)&&(!a[q-1]||"\\"!==a[q-1]))K&&K===l?K=!1:K||(K=l);c+=l}else r||(O||(h&&(b+="__SNAKESKIN_RESULT__ += '"),O=!0),k||h&&(b+=l))}b=this._uescape(b,x).replace(/__SNAKESKIN_ESCAPE__OR/g,
"||").replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return V[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");b+=!d?"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */":"";b+=f?"}":"";if(0!==m)throw j=Error("Missing closing or opening tag in the template (template: "+e+", "+this._genError(g)+")!"),j.name="Snakeskin Error",j;if(d)return b;L?f?eval(b):global.eval(b):window.eval(b);return b};
var F;if(L)for(F in Snakeskin)Snakeskin.hasOwnProperty(F)&&(exports[F]=Snakeskin[F])})("undefined"===typeof window);
