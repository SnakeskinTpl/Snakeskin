var Snakeskin={VERSION:"1.1.1",Filters:{},cache:{}},SS=Snakeskin;
(function(F){var y;Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});String.prototype.trim||(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),c=a.length;/\s/.test(a.charAt(c-=1)););return a.substring(0,c+1)});Snakeskin.forEach=function(a,c){var d=-1,b,h;if(Array.isArray(a))for(b=a.length;++d<b;)c(a[d],d,0===d,d===b-1,b);else{d=0;for(h in a)a.hasOwnProperty(h)&&d++;b=d;d=-1;for(h in a)a.hasOwnProperty(h)&&(d++,c(a[h],h,d,0===
d,d===b-1,b))}};var V={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},W=/[&<>"'\/]/g,X=function(a){return V[a]};Snakeskin.Filters.html=function(a){return String(a).replace(W,X)};var Y={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},Z=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g,$=function(a){return Y[a]};Snakeskin.Filters.uhtml=function(a){return String(a).replace(Z,$)};var aa=/<\/?[^>]+>/g;Snakeskin.Filters.stripTags=function(a){return String(a).replace(aa,
"")};var ba=/%5B/g,ca=/%5D/g;Snakeskin.Filters.uri=function(){return encodeURI(String(url)).replace(ba,"[").replace(ca,"]")};Snakeskin.Filters.upper=function(a){return String(a).toUpperCase()};Snakeskin.Filters.ucfirst=function(a){a=String(a);return a.charAt(0).toUpperCase()+a.substring(1)};Snakeskin.Filters.lower=function(a){return String(a).toLowerCase()};Snakeskin.Filters.lcfirst=function(a){a=String(a);return a.charAt(0).toLowerCase()+a.substring(1)};Snakeskin.Filters.trim=function(a){return String(a).trim()};
var da=/\s{2,}/g;Snakeskin.Filters.collapse=function(a){return String(a).replace(da," ").trim()};Snakeskin.Filters.truncate=function(a,c,d){a=String(a);if(!a||a.length<=c)return a;a=a.substring(0,c-1);var b;for(c=a.length;c--&&d;)if(" "===a.charAt(c))b=c;else if("undefined"!==typeof b)break;return("undefined"!==typeof b?a.substring(0,b):a)+"\u2026"};Snakeskin.Filters.repeat=function(a,c){return Array(c||1).join(a)};Snakeskin.Filters.remove=function(a,c){return String(a).replace(c,"")};Snakeskin.Filters.replace=
function(a,c,d){return String(a).replace(c,d)};Array.prototype.forEach||(Array.prototype.forEach=function(a,c){var d=-1,b=this.length;if(c)for(;(d+=1)<b;)a.call(c,this[d],d,this);else for(;(d+=1)<b;)a(this[d],d,this)});Array.prototype.some||(Array.prototype.some=function(a,c){var d=-1,b=this.length,h;if(c)for(;(d+=1)<b;){if(h=a.call(c,this[d],d,this))return!0}else for(;(d+=1)<b;)if(h=a(this[d],d,this))return!0;return!1});Array.prototype.reduce||(Array.prototype.reduce=function(a,c){var d=0,b=this.length,
h;if(1===b)return this[0];for(h="undefined"!==typeof c?c:this[0];(d+=1)<b;)h=a(h,this[d],d,this);return h});var G={},C={},v={},K={},D={},L={},H={},w={},M={},O=[],Q={'"':!0,"'":!0},ea={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_TMP_RESULT__:!0,__SNAKESKIN_CDATA__:!0},j;Snakeskin._getExtStr=function(a){if(!G[M[a]])throw j=Error('The specified pattern ("'+M[a]+'" for "'+a+'") for inheritance is not defined!'),j.name="Snakeskin Error",j;for(var c=M[a],d=G[c],b,h,e,f,k=-1,p,m=0,w=[],l,z,q;6>++k;)for(f in 0===
k?(b=C[a],h=C[c]):2===k?(b=D[a],h=D[c],m=L[c],p=null):4===k&&(b=v[a],h=v[c],m=K[c],p=null),b)if(b.hasOwnProperty(f))if(q=0,e=G[a].substring(b[f].from,b[f].to),h[f]&&(l=e.length-G[c].substring(h[f].from,h[f].to).length),z=h[f]?h[f].from:m,w.sort(function(a,b){if(a.val>b.val)return 1;if(a.val===b.val)return 0;if(a.val<b.val)return-1}).some(function(a){if(a.val<z)q+=a.adv;else return!0}),h[f]&&0===k%2)1<k&&(p=h[f].from+q+e.length,m+=l,p>m&&(m=p+(4===k?5:1))),d=d.substring(0,h[f].from+q)+e+d.substring(h[f].to+
q),w.push({val:h[f].from,adv:l});else if(!h[f])if(1===k)d+="{"+f+"}"+e+"{end}";else if(3===k||5===k)null===p&&(p=m,m+=q),e=3===k?"{"+e+"}":"{"+f+"}"+e+"{end}",d=d.substring(0,m)+e+d.substring(m),w.push({val:p,adv:e.length}),m+=e.length;return d};Snakeskin._escape=function(a){var c;a=a.split("");a.forEach(function(d,b){if(Q[d]){if(!a[b-1]||"\\"!==a[b-1])c&&c===d?c=!1:c||(c=d)}else if(c)switch(d){case "|":a[b]="__SNAKESKIN_ESCAPE__PIPE";break;case "=":a[b]="__SNAKESKIN_ESCAPE__EQUAL";break;case ",":a[b]=
"__SNAKESKIN_ESCAPE__COMMA";break;case "(":a[b]="__SNAKESKIN_ESCAPE__BOPEN";break;case ")":a[b]="__SNAKESKIN_ESCAPE__BCLOSE"}});return a=a.join("")};Snakeskin._descape=function(a){return a.replace(/__SNAKESKIN_ESCAPE__PIPE/g,"|").replace(/__SNAKESKIN_ESCAPE__EQUAL/g,"=").replace(/__SNAKESKIN_ESCAPE__COMMA/g,",").replace(/__SNAKESKIN_ESCAPE__BOPEN/g,"(").replace(/__SNAKESKIN_ESCAPE__BCLOSE/g,")")};Snakeskin.compile=function(a,c,d){a=String(a.innerHTML||a).replace(/{cdata}([\s\S]*?){end\s+cdata}/gm,
function(a,b){O.push(b);return"__SNAKESKIN_CDATA__"+(O.length-1)}).replace(/\/\/.*/gm,"").replace(/[\t\v\n\r]*/gm,"").replace(/\/\*[\s\S]*?\*\//g,"");for(var b=""+(!d?"/* This code is generated automatically, don't alter it. */":"")+(c?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":""),h,e=null,f,k,p,m,y=0,l=0,z,q=[],x=[],t,r,P=0,R,A={},B=[],I,J=[],S,T={},g="",N,s,U,n=-1,u,E;++n<a.length;){h=a.charAt(n);if(!E)if("{"===
h)if(m)y++;else{m=!0;continue}else if("}"===h&&(!y||!y--)){m=!1;g=this._escape(g);switch(g.split(" ")[0]){case "template":if(0!==l)throw j=Error('Missing closing or opening tag in the template (template: "'+e+'")!'),j.name="Snakeskin Error",j;l++;u=n+1;e=g.replace(/^template\s+/,"").replace(/\(.*/,"");if(d)break;/\s+extends\s+/.test(g)&&(f=g.replace(/.*?\s+extends\s+(.*)/,"$1"));k=g.replace(/.*?\((.*?)\).*/,"$1");C[e]={};v[e]={};K[e]=0;D[e]={};L[e]=0;H[e]={};M[e]=f;b+="/* Snakeskin template: "+e+
"; "+k.replace(/=(.*?)(?:,|$)/g,"")+" */";/\./.test(e)||c?(e.split(".").reduce(function(a,d,e){T[a]||(b+="if (typeof "+(c?"exports.":"")+a+" === 'undefined') { "+(c?"exports.":1===e?F?"var ":"window.":"")+a+" = {}; }",T[a]=!0);return a+"."+d}),b+=(c?"exports.":"")+e+"= function ("):b+=(!F?"window."+e+" = ":"")+"function "+(F?e:"")+"(";k=k.split(",");w[e]=w[f]?w[f].concat(k):k;p="";w[f]&&w[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();k.forEach(function(d,e){var c=
d.split("=");c[0]=c[0].trim();c[1]=c[1]&&c[1].trim();b[0]===c[0]&&"undefined"===typeof c[1]&&(k[e]=a)})});k.forEach(function(a,d){var c=a.split("=");c[0]=c[0].trim();b+=c[0];1<c.length&&(w[f]&&!p&&w[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();!k.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]})&&"undefined"!==typeof b[1]&&(p+="var "+b[0]+" = "+b[1]+";",H[e][b[0]]=a)}),c[1]=c[1].trim(),p+=c[0]+" = typeof "+c[0]+" !== 'undefined' && "+
c[0]+" !== null ? "+c[0]+" : "+c[1]+";");H[e][c[0]]=a;d!==k.length-1&&(b+=",")});b+=") { "+p+"var __SNAKESKIN_RESULT__ = '', __SNAKESKIN_TMP_RESULT__;";break;case "if":l++;!f&&!r&&(b+="if ("+g.replace(/^\/?if\s+/,"")+") {");break;case "elseIf":!f&&!r&&(b+="} else if ("+g.replace(/^elseIf\s+/,"")+") {");break;case "else":!f&&!r&&(b+="} else {");break;case "with":B.push({scope:g.replace(/^with\s+/,""),i:++l});break;case "proto":if(!d&&(f&&!q.length&&!x.length||!f)){if(v[e][g])throw j=Error('Proto "'+
g.replace(/^proto\s+/,"")+'" is already defined (template: "'+e+'")!'),j.name="Snakeskin Error",j;v[e][g]={from:n-u+1}}x.push({name:g,i:++l,startI:n+1});f||(r=!0);break;case "apply":!f&&!x.length&&(g=g.replace(/^apply/,"proto"),v[e][g]?b+=v[e][g].body:(A[g]||(A[g]=[],A[g].protoStart=r,R=g.replace(/^proto\s+/,""),P++),A[g].push(b.length)));break;case "block":if(!d&&(f&&!q.length&&!x.length||!f)){if(C[e][g])throw j=Error('Block "'+g.replace(/^block\s+/,"")+'" is already defined (template: "'+e+'")!'),
j.name="Snakeskin Error",j;C[e][g]={from:n-u+1}}q.push({name:g,i:++l});break;case "forEach":J.push(++l);!f&&!r&&(g=g.replace(/^forEach\s+/,"").split("=>"),b+=g[0]+" && Snakeskin.forEach("+g[0]+", function ("+(g[1]||"")+") {");break;case "end":l--;h=q[q.length-1];t=x[x.length-1];I=B[B.length-1];S=J[J.length-1];if(0===l){if(P)throw j=Error('Proto "'+R+'" is not defined (template: "'+e+'")!'),j.name="Snakeskin Error",j;if(d)break;G[e]=a.substring(u,n-g.length-1);if(f){a=a.substring(0,u)+this._getExtStr(e)+
a.substring(n-g.length-1);C[e]={};v[e]={};K[e]=0;D[e]={};L[e]=0;H[e]={};n=u-1;l++;z=m=f=!1;g="";continue}b+="return __SNAKESKIN_RESULT__; }; Snakeskin.cache['"+e+"'] = "+(c?"exports.":"")+e+";";e=null}else if(!f&&(!t||t.i!==l+1)&&(!h||h.i!==l+1)&&(!I||I.i!==l+1))S===l+1?(J.pop(),r||(b+="});")):r||(b+="};");if(h&&h.i===l+1&&(q.pop(),!d&&(f&&!q.length&&!x.length||!f)))C[e][h.name].to=n-u-g.length-1;if(t&&t.i===l+1){x.pop();if(!d&&(f&&!q.length&&!x.length||!f))v[e][t.name].to=n-u-g.length-1,K[e]=n-u+
1;f||(v[e][t.name].body=this.compile("{template "+e+"()}"+a.substring(t.startI,n-g.length-1)+"{end}",null,!0));A[t.name]&&!A[t.name].protoStart&&(A[t.name].forEach(function(a){b=b.substring(0,a)+v[e][t.name].body+b.substring(a)}),delete A[t.name],P--);x.length||(r=!1)}I&&I.i===l+1&&B.pop();break;default:if(!f&&!r&&/console\./.test(g)){b+=g+";";break}if(/=(?!=)/.test(g)){s=g.split("=")[0].trim();if(D[e][s]||H[e][s])throw j=Error('Variable "'+s+'" is already defined (template: "'+e+'")!'),j.name="Snakeskin Error",
j;if(ea[s])throw j=Error("Can't declare variable \""+s+'", try another name (template: "'+e+'")!'),j.name="Snakeskin Error",j;if(J.length)throw j=Error('Variable "'+s+'" can\'t be defined in a loop (template: "'+e+'")!'),j.name="Snakeskin Error",j;D[e][s]={from:n-u-g.length,to:n-u};L[e]=n-u+1;!f&&!r&&(b+="var "+g+";")}else!f&&!r&&(s="",U=1,N=!1,g.split("|").forEach(function(a,b){var c,d;0===b?B.length?(B.push({scope:a}),s=B.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),
B.pop()):s=a:(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(U++,s="Snakeskin.Filters['"+c[0]+"']("+s+(d.length?", "+d.join(""):"")+")"):N=!0)}),b+="__SNAKESKIN_TMP_RESULT__ = "+(!N?"Snakeskin.Filters.html(":"")+s+(!N?")":"")+";",b+="__SNAKESKIN_RESULT__ += typeof __SNAKESKIN_TMP_RESULT__ === 'undefined' ? '' : __SNAKESKIN_TMP_RESULT__;")}g="";continue}if(m){!r&&z&&(b+="';",z=!1);if((Q[h]||"/"===h)&&(!a[n-1]||"\\"!==a[n-1]))E&&E===h?E=!1:E||(E=h);g+=h}else r||(z||(b+="__SNAKESKIN_RESULT__ += '",z=!0),
f||(b+=h))}b=this._descape(b).replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return O[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/\'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");b+=!d?"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */":"";b+=c?"}":"";if(0!==l)throw j=Error("Missing closing or opening tag in the template!"),j.name="Snakeskin Error",j;if(d)return b;F?c?eval(b):global.eval(b):window.eval(b);return b};if(F)for(y in Snakeskin)Snakeskin.hasOwnProperty(y)&&
(exports[y]=Snakeskin[y])})("undefined"===typeof window);
