var Snakeskin={Filters:{}};(function(){Snakeskin.forEach=function(g,q){var c=-1,m,p;if(Array.isArray(g))for(m=g.length;++c<m;)q(g[c],c,0===c,c===m-1,m);else{c=0;for(p in g)g.hasOwnProperty(p)&&c++;m=c;c=-1;for(p in g)g.hasOwnProperty(p)&&(c++,q(g[p],p,c,0===c,c===m-1,m))}};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},x=/[&<>"'\/]/g,q=function(g){return B[g]};Snakeskin.Filters.html=function(g){return String(g).replace(x,q)}})();
(function(B){var x={},q={},g={},F={},c={},m={},p=[],I={'"':!0,"'":!0},t;Snakeskin._getExtStr=function(s){for(var d=x[m[s]],c=d.length,a,j=q[s],e=q[m[s]],f,b,h=-1,k=0;4>++h;)for(b in 1<h&&(j=g[s],e=g[m[s]],c=d.length),j)j.hasOwnProperty(b)&&(a=d.length-c,f=x[s].substring(j[b].from,j[b].to),e[b]&&(0===h||2===h)?(1<h&&(k=e[b].from+a+f.length+1),d=d.substring(0,e[b].from+a)+f+d.substring(e[b].to+a,d.length)):e[b]||(1===h?d+="{"+b+"}"+f+"{/end}":3===h&&(f="{"+f+"}",d=d.substring(0,k)+f+d.substring(k,d.length),
k+=f.length)));return d};Snakeskin._escape=function(c){var d;c=c.split("");c.forEach(function(g,a){if(I[g]){if(!c[a-1]||"\\"!==c[a-1])d=d&&d===g?!1:g}else if(d)switch(g){case "|":c[a]="__SNAKESKIN_ESCAPE__PIPE";break;case "=":c[a]="__SNAKESKIN_ESCAPE__EQUAL";break;case ",":c[a]="__SNAKESKIN_ESCAPE__COMMA";break;case "(":c[a]="__SNAKESKIN_ESCAPE__BOPEN";break;case ")":c[a]="__SNAKESKIN_ESCAPE__BCLOSE"}});return c=c.join("")};Snakeskin._descape=function(c){return c.replace(/__SNAKESKIN_ESCAPE__PIPE/g,
"|").replace(/__SNAKESKIN_ESCAPE__EQUAL/g,"=").replace(/__SNAKESKIN_ESCAPE__COMMA/g,",").replace(/__SNAKESKIN_ESCAPE__BOPEN/g,"(").replace(/__SNAKESKIN_ESCAPE__BCLOSE/g,")")};Snakeskin.compile=function(s,d){var w=(s.innerHTML||s).replace(/{cdata}([\s\S]*?){\/cdata}/,function(a,b){p.push(b);return"@cdata_"+(p.length-1)}).replace(/\/\/.*/g,"").replace(/^\s*|\s*$/g,"").replace(/{\/end}\s*{template/g,"{/end}{template").replace(/[\t]/g,"").replace(/[\n\r]/g,"").replace(/\/\*[\s\S]*?\*\//g,""),a="/* This code is generated automatically, don't alter it. */",
j,e,f,b,h,k,y,t=0,l=0,z,C=[],u=[],A,D=[],G;b="";for(var E,n,H,r=-1,v;++r<w.length;){j=w.charAt(r);if("{"===j)if(y)t++;else{y=!0;continue}else if("}"===j&&(!t||!t--)){y=!1;b=this._escape(b);switch(b.split(" ")[0]){case "template":l++;e=b.replace(/^template\s+/,"").replace(/\(.*/,"");/\s+extends\s+/.test(b)&&(f=b.replace(/.*?\s+extends\s+(.*)/,"$1"));h=b.replace(/.*?\((.*?)\).*/,"$1");q[e]={};g[e]={};F[e]={};m[e]=f;a+="/* Snakeskin template: "+e+"; "+h.replace(/=(.*?)(?:,|$)/g,"")+" */";a=/\./.test(e)||
d?a+((d?"exports.":"")+e+"= function ("):a+("function "+e+"(");v=r+1;h=h.split(",");c[e]=c[f]?c[f].concat(h):h;k="";c[f]&&c[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();h.forEach(function(c,f){var e=c.split("=");e[0]=e[0].trim();e[1]=e[1]&&e[1].trim();b[0]===e[0]&&"undefined"===typeof e[1]&&(h[f]=a)})});h.forEach(function(b,g){var d=b.split("=");d[0]=d[0].trim();a+=d[0];1<d.length&&(c[f]&&!k&&c[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&
b[1].trim();h.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]})||(k="undefined"!==typeof b[1]?k+("var "+b[0]+" = typeof "+b[0]+" !== 'undefined' && "+b[0]+" !== null ? "+b[0]+" : "+b[1]+";"):k+("var "+b[0]+";"))}),d[1]=d[1].trim(),F[e][d[0]]=b,k+=d[0]+" = typeof "+d[0]+" !== 'undefined' && "+d[0]+" !== null ? "+d[0]+" : "+d[1]+";");g!==h.length-1&&(a+=",")});a+=") { "+k+"var __RESULT__ = '';";break;case "if":l++;f||(a+="if ("+b.replace(/^\/?if\s+/,"")+") {");
break;case "elseIf":f||(a+="} else if ("+b.replace(/^elseIf\s+/,"")+") {");break;case "else":f||(a+="} else {");break;case "with":u.push({scope:b.replace(/^with\s+/,""),i:++l});break;case "block":q[e][b]={from:r-v+1};C.push({name:b,i:++l});break;case "forEach":D.push(++l);f||(b=b.replace(/^forEach\s+/,"").split("=>"),a+=b[0]+" && Snakeskin.forEach("+b[0]+", function ("+(b[1]||"")+") {");break;case "/end":l--;j=C[C.length-1];A=u[u.length-1];G=D[D.length-1];if(0===l){x[e]=w.substring(v,r-b.length-1);
if(f){w=w.substring(0,v)+this._getExtStr(e)+w.substring(r-b.length-1,w.length);g[e]={};r=v-1;l++;z=y=f=!1;b="";continue}a+="return __RESULT__; };"}else if(!f&&(!j||j.i!==l+1)&&(!A||A.i!==l+1))G===l+1?(D.pop(),a+="});"):a+="};";j&&j.i===l+1&&(q[e][j.name].to=r-v-b.length-1,C.pop());A&&A.i===l+1&&u.pop();break;default:if(!f&&/console\./.test(b)){a+=b+";";break}if(/=(?!=)/.test(b)){n=b.split("=")[0].trim();if(g[e][n]||F[e][n])throw Error('Variable "'+n+'" has already defined (template: "'+e+'")!');g[e][n]=
{from:r-v-b.length,to:r-v};f||(a+="var "+b+";")}else f||(n="",H=1,E=!1,b.split("|").forEach(function(a,b){var c,d;0===b?u.length?(u.push({scope:a}),n=u.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),u.pop()):n=a:(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(H++,n="Snakeskin.Filters['"+c[0]+"']("+n+(d.length?", "+d.join(""):"")+")"):E=!0)}),a+="__RESULT__ += "+(!E?"Snakeskin.Filters.html(":"")+n+(!E?")":"")+";")}b="";continue}y?(z&&(a+="';",z=!1),b+=j):(z||(a+="__RESULT__ += '",
z=!0),f||(a+=j))}a=this._descape(a).replace(/@cdata_(\d+)/g,function(a,b){return p[b].replace(/[\n\r]/g,"").replace(/\'/g,"&#39;")}).replace(/__RESULT__ \+= '';/g,"");a+="/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */";if(0!==l)throw Error("Missing closing or opening tag in the template!");B?d?eval(a):global.eval(a):window.eval(a);return a};if(B)for(t in Snakeskin)Snakeskin.hasOwnProperty(t)&&(exports[t]=Snakeskin[t])})("undefined"===typeof window);
