var Snakeskin={Filters:{}};
(function(F){var p;Snakeskin.forEach=function(d,g){var c=-1,a,h;if(Array.isArray(d))for(a=d.length;++c<a;)g(d[c],c,0===c,c===a-1,a);else{c=0;for(h in d)d.hasOwnProperty(h)&&c++;a=c;c=-1;for(h in d)d.hasOwnProperty(h)&&(c++,g(d[h],h,c,0===c,c===a-1,a))}};var I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},J=/[&<>"'\/]/g,K=function(d){return I[d]};Snakeskin.Filters.html=function(d){return String(d).replace(J,K)};var C={},u={},t={},D={},s={},z={},E=[],L={'"':!0,"'":!0};Snakeskin._getExtStr=
function(d){for(var g=C[z[d]],c=g.length,a,h=u[d],e=u[z[d]],f,b,j=-1,k=0;4>++j;)for(b in 1<j&&(h=t[d],e=t[z[d]],c=g.length),h)h.hasOwnProperty(b)&&(a=g.length-c,f=C[d].substring(h[b].from,h[b].to),e[b]&&(0===j||2===j)?(1<j&&(k=e[b].from+a+f.length+1),g=g.substring(0,e[b].from+a)+f+g.substring(e[b].to+a,g.length)):e[b]||(1===j?g+="{"+b+"}"+f+"{/end}":3===j&&(f="{"+f+"}",g=g.substring(0,k)+f+g.substring(k,g.length),k+=f.length)));return g};Snakeskin._escape=function(d){var g;d=d.split("");d.forEach(function(c,
a){if(L[c]){if(!d[a-1]||"\\"!==d[a-1])g=g&&g===c?!1:c}else if(g)switch(c){case "|":d[a]="__SNAKESKIN_ESCAPE__PIPE";break;case "=":d[a]="__SNAKESKIN_ESCAPE__EQUAL";break;case ",":d[a]="__SNAKESKIN_ESCAPE__COMMA";break;case "(":d[a]="__SNAKESKIN_ESCAPE__BOPEN";break;case ")":d[a]="__SNAKESKIN_ESCAPE__BCLOSE"}});return d=d.join("")};Snakeskin._descape=function(d){return d.replace(/__SNAKESKIN_ESCAPE__PIPE/g,"|").replace(/__SNAKESKIN_ESCAPE__EQUAL/g,"=").replace(/__SNAKESKIN_ESCAPE__COMMA/g,",").replace(/__SNAKESKIN_ESCAPE__BOPEN/g,
"(").replace(/__SNAKESKIN_ESCAPE__BCLOSE/g,")")};Snakeskin.compile=function(d,g){var c=(d.innerHTML||d).replace(/{cdata}([\s\S]*?){\/cdata}/,function(a,b){E.push(b);return"@cdata_"+(E.length-1)}).replace(/\/\/.*/g,"").replace(/^\s*|\s*$/g,"").replace(/{\/end}\s*{template/g,"{/end}{template").replace(/[\t]/g,"").replace(/[\n\r]/g,"").replace(/\/\*[\s\S]*?\*\//g,""),a="/* This code is generated automatically, don't alter it. */"+(g?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);return this;};":
""),h,e,f,b,j,k,v,p=0,l=0,w,A=[],q=[],x,y=[],G;b="";for(var B,m,H,n=-1,r;++n<c.length;){h=c.charAt(n);if("{"===h)if(v)p++;else{v=!0;continue}else if("}"===h&&(!p||!p--)){v=!1;b=this._escape(b);switch(b.split(" ")[0]){case "template":l++;e=b.replace(/^template\s+/,"").replace(/\(.*/,"");/\s+extends\s+/.test(b)&&(f=b.replace(/.*?\s+extends\s+(.*)/,"$1"));j=b.replace(/.*?\((.*?)\).*/,"$1");u[e]={};t[e]={};D[e]={};z[e]=f;a+="/* Snakeskin template: "+e+"; "+j.replace(/=(.*?)(?:,|$)/g,"")+" */";a=/\./.test(e)||
g?a+((g?"exports.":"")+e+"= function ("):a+("function "+e+"(");r=n+1;j=j.split(",");s[e]=s[f]?s[f].concat(j):j;k="";s[f]&&s[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();j.forEach(function(d,c){var e=d.split("=");e[0]=e[0].trim();e[1]=e[1]&&e[1].trim();b[0]===e[0]&&"undefined"===typeof e[1]&&(j[c]=a)})});j.forEach(function(b,d){var c=b.split("=");c[0]=c[0].trim();a+=c[0];1<c.length&&(s[f]&&!k&&s[f].forEach(function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&
b[1].trim();j.some(function(a){a=a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]})||(k="undefined"!==typeof b[1]?k+("var "+b[0]+" = typeof "+b[0]+" !== 'undefined' && "+b[0]+" !== null ? "+b[0]+" : "+b[1]+";"):k+("var "+b[0]+";"))}),c[1]=c[1].trim(),D[e][c[0]]=b,k+=c[0]+" = typeof "+c[0]+" !== 'undefined' && "+c[0]+" !== null ? "+c[0]+" : "+c[1]+";");d!==j.length-1&&(a+=",")});a+=") { "+k+"var __RESULT__ = '';";break;case "if":l++;f||(a+="if ("+b.replace(/^\/?if\s+/,"")+") {");
break;case "elseIf":f||(a+="} else if ("+b.replace(/^elseIf\s+/,"")+") {");break;case "else":f||(a+="} else {");break;case "with":q.push({scope:b.replace(/^with\s+/,""),i:++l});break;case "block":u[e][b]={from:n-r+1};A.push({name:b,i:++l});break;case "forEach":y.push(++l);f||(b=b.replace(/^forEach\s+/,"").split("=>"),a+=b[0]+" && Snakeskin.forEach("+b[0]+", function ("+(b[1]||"")+") {");break;case "/end":l--;h=A[A.length-1];x=q[q.length-1];G=y[y.length-1];if(0===l){C[e]=c.substring(r,n-b.length-1);
if(f){c=c.substring(0,r)+this._getExtStr(e)+c.substring(n-b.length-1,c.length);t[e]={};n=r-1;l++;w=v=f=!1;b="";continue}a+="return __RESULT__; };"}else if(!f&&(!h||h.i!==l+1)&&(!x||x.i!==l+1))G===l+1?(y.pop(),a+="});"):a+="};";h&&h.i===l+1&&(u[e][h.name].to=n-r-b.length-1,A.pop());x&&x.i===l+1&&q.pop();break;default:if(!f&&/console\./.test(b)){a+=b+";";break}if(/=(?!=)/.test(b)){m=b.split("=")[0].trim();if(t[e][m]||D[e][m])throw Error('Variable "'+m+'" has already defined (template: "'+e+'")!');if(y.length)throw Error('Variable "'+
m+'" can\'t be defined in a loop (template: "'+e+'")!');t[e][m]={from:n-r-b.length,to:n-r};f||(a+="var "+b+";")}else f||(m="",H=1,B=!1,b.split("|").forEach(function(a,b){var c,d;0===b?q.length?(q.push({scope:a}),m=q.reduce(function(a,b){return("undefined"===typeof a.scope?a:a.scope)+"."+b.scope}),q.pop()):m=a:(c=a.split(" "),d=c.slice(1),"!html"!==c[0]?(H++,m="Snakeskin.Filters['"+c[0]+"']("+m+(d.length?", "+d.join(""):"")+")"):B=!0)}),a+="__RESULT__ += "+(!B?"Snakeskin.Filters.html(":"")+m+(!B?")":
"")+";")}b="";continue}v?(w&&(a+="';",w=!1),b+=h):(w||(a+="__RESULT__ += '",w=!0),f||(a+=h))}a=this._descape(a).replace(/@cdata_(\d+)/g,function(a,b){return E[b].replace(/[\n\r]/g,"").replace(/\'/g,"&#39;")}).replace(/__RESULT__ \+= '';/g,"");a+="/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */";if(0!==l)throw Error("Missing closing or opening tag in the template!");F?g?eval(a):global.eval(a):window.eval(a);return a};if(F)for(p in Snakeskin)Snakeskin.hasOwnProperty(p)&&
(exports[p]=Snakeskin[p])})("undefined"===typeof window);
