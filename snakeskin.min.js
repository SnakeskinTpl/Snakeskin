var Snakeskin={VERSION:"2.3.1",Directions:{},Filters:{},BEM:{},Vars:{},write:{},cache:{}};
(function(G){function M(b){return N[b]}function O(b){return P[b]}function n(b,c,a){var d=this.prototype,e;for(e in d)d.hasOwnProperty(e)&&d[e].init&&(this[e]=d[e].init());this.canWrite=!0;this.i=-1;this.openBlockI=0;this.posCache={};this.sysPosCache={};this.quotContent=[];var f=this.cDataContent=[];this.source=String(b).replace(/{cdata}([\s\S]*?){(?:\/cdata|end cdata)}/gm,function(a,b){f.push(b);return"__SNAKESKIN_CDATA__"+(f.length-1)}).trim();this.res=(a?"":"/* This code is generated automatically, don't alter it. */")+
(c?"var Snakeskin = global.Snakeskin;exports.liveInit = function (path) { Snakeskin = require(path);exec();return this;};function exec() {":"")}Array.isArray||(Array.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)});String.prototype.trim||(String.prototype.trim=function(){for(var b=this.replace(/^\s\s*/,""),c=b.length;/\s/.test(b.charAt(--c)););return b.substring(0,c+1)});Snakeskin.forEach=function(b,c,a){var d=-1,e;if(Array.isArray(b))for(e=b.length;++d<e;)if(a){if(!1===
c.call(a,b[d],d,0===d,d===e-1,e))break}else{if(!1===c(b[d],d,0===d,d===e-1,e))break}else{var d=0,f;for(f in b)b.hasOwnProperty(f)&&d++;e=d;d=-1;for(f in b)if(b.hasOwnProperty(f))if(d++,a){if(!1===c.call(a,b[f],f,d,0===d,d===e-1,e))break}else if(!1===c(b[f],f,d,0===d,d===e-1,e))break}};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},Q=/[&<>"'\/]/g;Snakeskin.Filters.html=function(b){return(b+"").replace(Q,M)};Snakeskin.Filters.undef=function(b){return"undefined"!==typeof b?
b:""};var P={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/"},R=/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;/g;Snakeskin.Filters.uhtml=function(b){return(b+"").replace(R,O)};var S=/<\/?[^>]+>/g;Snakeskin.Filters.stripTags=function(b){return(b+"").replace(S,"")};var T=/%5B/g,U=/%5D/g;Snakeskin.Filters.uri=function(b){return encodeURI(b+"").replace(T,"[").replace(U,"]")};Snakeskin.Filters.upper=function(b){return(b+"").toUpperCase()};Snakeskin.Filters.ucfirst=function(b){b+="";return b.charAt(0).toUpperCase()+
b.substring(1)};Snakeskin.Filters.lower=function(b){return(b+"").toLowerCase()};Snakeskin.Filters.lcfirst=function(b){b+="";return b.charAt(0).toLowerCase()+b.substring(1)};Snakeskin.Filters.trim=function(b){return(b+"").trim()};var V=/\s{2,}/g;Snakeskin.Filters.collapse=function(b){return(b+"").replace(V," ").trim()};Snakeskin.Filters.truncate=function(b,c,a){b+="";if(!b||b.length<=c)return b;b=b.substring(0,c-1);var d;for(c=b.length;c--&&a;)if(" "===b.charAt(c))d=c;else if("undefined"!==typeof d)break;
return("undefined"!==typeof d?b.substring(0,d):b)+"\u2026"};Snakeskin.Filters.repeat=function(b,c){return Array(c||2).join(b)};Snakeskin.Filters.remove=function(b,c){return(b+"").replace(c,"")};Snakeskin.Filters.replace=function(b,c,a){return(b+"").replace(c,a)};Snakeskin.Filters.json=function(b){return"object"===typeof b?JSON.stringify(b):b+""};Array.prototype.reduce||(Array.prototype.reduce=function(b,c){var a=0,d=this.length,e;if(1===d)return this[0];for(e="undefined"!==typeof c?c:this[0];++a<
d;)e=b(e,this[a],a,this);return e});var F={},y={},t={},H={},u={},I={},B={},z={},J={},W={__SNAKESKIN_RESULT__:!0,__SNAKESKIN_CDATA__:!0},E={'"':!0,"'":!0,"/":!0},L={",":!0,";":!0,"=":!0,"|":!0,"&":!0,"?":!0,":":!0,"(":!0};Snakeskin.DirObj=n;n.prototype.save=function(b){this.tplName&&!1===Snakeskin.write[this.tplName]||(this.res+=b)};n.prototype.replace=function(b){this.canWrite&&(this.res=b)};n.prototype.pushPos=function(b,c,a){a?(this.sysPosCache[b]||(this.sysPosCache[b]=[]),this.sysPosCache[b].push(c)):
(this.posCache[b]||(this.posCache[b]=[]),this.posCache[b].push(c))};n.prototype.popPos=function(b){return this.sysPosCache[b]?this.sysPosCache[b].pop():this.posCache[b].pop()};n.prototype.getPos=function(b){return this.sysPosCache[b]?this.sysPosCache[b]:this.posCache[b]};n.prototype.hasPos=function(b){return this.sysPosCache[b]?!!this.sysPosCache[b].length:!(!this.posCache[b]||!this.posCache[b].length)};n.prototype.getLastPos=function(b){if(this.sysPosCache[b]){if(this.sysPosCache[b].length)return this.sysPosCache[b][this.sysPosCache[b].length-
1]}else if(this.posCache[b]&&this.posCache[b].length)return this.posCache[b][this.posCache[b].length-1]};n.prototype.isNotSysPos=function(b){var c=!0;Snakeskin.forEach(this.sysPosCache,function(a,d){return(a=this.getLastPos(d))&&("undefined"!==typeof a.i&&a.i===b||a===b)?c=!1:!0},this);return c};n.prototype.replaceDangerBlocks=function(b,c){var a,d,e=!0,f,g=0;return b.split("").reduce(function(h,k,m){a||(L[k]?e=!0:/[^\s\/]/.test(k)&&(e=!1));if(E[k]&&("/"===k?e:1)&&!a)a=k,f=m;else if(a&&("\\"===k||
d))d=!d;else if(E[k]&&a===k&&!d){a=!1;k=b.substring(f,m+1);var l="__SNAKESKIN_QUOT__"+(c?c.length:"_");c&&c.push(k);h=h.substring(0,f-g)+l+h.substring(m+1-g);g+=k.length-l.length}return h},b)};n.prototype.pasteDangerBlocks=function(b,c){return b.replace(/__SNAKESKIN_QUOT__(\d+)/g,function(a,b){return c[b]})};n.prototype.getExtStr=function(b,c){if("undefined"===typeof F[J[b]])throw this.error('The specified pattern ("'+J[b]+'" for "'+b+'") for inheritance is not defined ('+this.genErrorAdvInfo(c)+
")!");for(var a=J[b],d=F[a],e=0,f=[],g=-1;6>++g;){var h,k,m;0===g?(h=y[b],k=y[a]):2===g?(h=u[b],k=u[a],e=I[a],m=null):4===g&&(h=t[b],k=t[a],e=H[a],m=null);for(var l in h)if(h.hasOwnProperty(l)){var q=0,n=F[b].substring(h[l].from,h[l].to);if(k[l])var v=n.length-F[a].substring(k[l].from,k[l].to).length;var p=k[l]?k[l].from:e;Snakeskin.forEach(f.sort(function(a,b){return a.val>b.val?1:a.val===b.val?0:-1}),function(a){if(a.val<p)q+=a.adv;else return!1;return!0});if(k[l]&&0===g%2)1<g&&(m=k[l].from+q+n.length,
e+=v,m>e&&(e=m+(4===g?5:1))),d=d.substring(0,k[l].from+q)+n+d.substring(k[l].to+q),f.push({val:k[l].from,adv:v});else if(!k[l])if(1===g)d+="{block "+l+"}"+n+"{end}";else if(3===g||5===g)null===m&&(m=e,e+=q),n=3===g?"{"+n+"}":"{proto "+l+"}"+n+"{end}",d=d.substring(0,e)+n+d.substring(e),f.push({val:m,adv:n.length}),e+=n.length}}return d};n.prototype.genErrorAdvInfo=function(b){var c="",a;for(a in b)b.hasOwnProperty(a)&&(c=b[a].innerHTML?c+(a+": (class: "+(b[a].className||"undefined")+", id: "+(b[a].id||
"undefined")+"), "):c+(a+": "+b[a]+", "));return c.replace(/, $/,"")};n.prototype.error=function(b){b=Error(b);b.name="Snakeskin Error";return b};Snakeskin.compile=function(b,c,a,d,e){a=a||{};b.innerHTML&&(a.node=b);var f=new n(b.innerHTML||b,c,d);f.sysPosCache["with"]=e;var g;b=0;var h;e="";for(var k=!1,m,l,q=!0,K=!1;++f.i<f.source.length;){var v=f.source,p=v.charAt(f.i),C=v.charAt(f.i+1);if(!l){if(g){if("\\"===p||k)k=!k}else k=!1;if(!k)if("/"===p)if("/"===C&&"/"===v.charAt(f.i+2))m="///";else if("*"===
C)m="/*",f.i++;else{if("*"===v.charAt(f.i-1)){m=!1;continue}}else/[\n\v\r]/.test(p)&&"///"===m&&(m=!1);if(m)continue;if("{"===p)if(g)b++;else{g=!0;continue}else if(!("}"!==p||b&&b--)){g=!1;v=e.length;e=f.replaceDangerBlocks(e,f.quotContent).trim();p=e.replace(/^\//,"end ").replace(/^{([\s\S]*)}$/,function(a,b){return"data "+b}).split(" ")[0];p=Snakeskin.Directions[p]?p:"const";!1===Snakeskin.Directions[p]("const"!==p?e.replace(RegExp("^"+p+"\\s+"),""):e,v,f,{commonJS:c,dryRun:d,info:a})&&(h=g=!1);
e="";continue}}g?(h&&!f.protoStart&&(f.save("';"),h=!1),"/"!==e&&(l||(L[p]?q=!0:/[^\s\/]/.test(p)&&(q=!1)),E[p]&&("/"===p?q:1)&&!l?l=p:l&&("\\"===p||K)?K=!K:E[p]&&(l===p&&!K)&&(l=!1)),e+=p):f.protoStart||(h||(f.save("__SNAKESKIN_RESULT__ += '"),h=!0),f.parentTplName||f.save(p.replace(/\\/gm,"\\\\").replace(/'/gm,"\\'")))}if(0!==f.openBlockI)throw f.error("Missing closing or opening tag in the template, "+f.genErrorAdvInfo(a)+'")!');f.res=f.pasteDangerBlocks(f.res,f.quotContent).replace(/[\t\v\r\n]/gm,
"").replace(/__SNAKESKIN_CDATA__(\d+)/g,function(a,b){return f.cDataContent[b].replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\v/gm,"\\v").replace(/'/gm,"&#39;")}).replace(/__SNAKESKIN_RESULT__ \+= '';/g,"");f.res+=d?"":"/* Snakeskin templating system. Generated at: "+(new Date).toString()+". */";f.res+=c?"}":"";if(d)return f.res;G?c?eval(f.res):global.eval(f.res):window.eval(f.res);return f.res};var X={"break":!0,"case":!0,"catch":!0,"continue":!0,"delete":!0,"do":!0,"else":!0,"false":!0,finnaly:!0,
"for":!0,"function":!0,"if":!0,"in":!0,"instanceof":!0,"new":!0,"null":!0,"return":!0,"switch":!0,"this":!0,"throw":!0,"true":!0,"try":!0,"typeof":!0,"var":!0,"void":!0,"while":!0,"with":!0,"class":!0,let:!0,"const":!0,"debugger":!0,"interface":!0},Y={"var":!0,let:!0,"const":!0};n.prototype.replaceTplVars=function(b){b=this.pasteDangerBlocks(b,this.quotContent);for(var c=0,a,d=!1,e,f,g=!0,h=!1,k="",m=0;m<b.length;m++){var l=b.charAt(m),q=b.charAt(m+1);if(c||"$"!==l||"{"!==q){if(c||(k+=l.replace(/\\/g,
"\\\\").replace(/('|")/g,"\\$1")),c){if("\\"===l||d)d=!d;if(!d)if("/"===l)if("/"===q&&"/"===b.charAt(m+2))e="///";else if("*"===q)e="/*",m++;else{if("*"===b.charAt(m-1)){e=!1;continue}}else/[\n\v\r]/.test(l)&&"///"===e&&(e=!1);e||(f||(L[l]?g=!0:/[^\s\/]/.test(l)&&(g=!1)),E[l]&&("/"===l?g:1)&&!f?f=l:f&&("\\"===l||h)?h=!h:E[l]&&(f===l&&!h)&&(f=!1),f||("{"===l?c++:"}"===l&&c--),c?a+=l:(d=!1,k+="' + "+this.prepareOutput(this.replaceDangerBlocks(a,this.quotContent))+" + '"))}}else c++,a="",m++}return k};
n.prototype.isPrevSyOL=function(b,c){for(var a=c;a--;){var d=b.charAt(a);if(/\S/.test(d))return"{"===d}return!1};n.prototype.isNextSyOL=function(b,c){for(var a=c;a<b.length;a++){var d=b.charAt(a);if(/\S/.test(d))return":"===d||"="===d&&"="!==b.charAt(a+1)&&"="!==b.charAt(a-1)}return!1};n.prototype.getWord=function(b,c){for(var a="",d=0,e,f=null,g=c,h=0;g<b.length;g++,h++){var k=b.charAt(g);if(d||/[@#$+\-\w\[\]().]/.test(k)){null!==f&&(1<d||1===d&&")"!==k)&&(f+=k);if("("===k)null===f&&(e=h+1,f=""),
d++;else if(")"===k)if(d)d--;else break;a+=k}else break}return{word:a,finalWord:f?a.substring(0,e)+this.prepareOutput(f,!0)+a.substring(h-1):a}};n.prototype.prepareOutput=function(b,c,a){var d=0,e=0,f=[],g,h=[],k=[],m=b,l=0,q=!a;a=0;for(var n=this.hasPos("with"),v=this.getPos("with"),p=0,C=0,t=!1,y=!1,s=0;s<b.length;s++){var r=b.charAt(s),A=b.charAt(s+1),u=b.charAt(s+2),x;if(!x){"("===r&&(g?e++:(f.unshift([s+p]),d++));if(q&&!a&&/[@#$a-z_]/i.test(r)){q=this.getWord(b,s);x=q.word;var q=q.finalWord,
u=p+l,z=!X[x]&&!/^__SNAKESKIN_QUOT__\d+/.test(x)&&!this.isPrevSyOL(b,s)&&!this.isNextSyOL(b,s+x.length),D=/([$\w]*)(.*)/;if("@"===r)z&&n?(r=q.substring("@"===A?2:1),D=D.exec(r),"@"===A&&(r="Snakeskin.Vars['"+D[1]+"']"+D[2])):(D=D.exec(q.substring("@"===A?2:1)),r="Snakeskin.Vars['"+D[1]+"']"+D[2]);else if(A=q.replace(/#(?:\d+|)/,""),z&&n){var w=null;"#"===r&&(w=(w=/#(\d+)/.exec(q))?w[1]:1,w++);v.push({scope:A});var B=w=w?v.length-w:w,r=v.reduce(function(a,b,c,e){w=w?w-1:w;a="undefined"===typeof a.scope?
a:a.scope;return null===w||0<w?a+"."+b.scope:c===e.length-1?(0<B?a+".":"")+b.scope:a});v.pop()}else r=A;Y[q]?a=2:z&&!c&&(r="Snakeskin.Filters.undef("+r+")");p+=r.length-x.length;q=!1;g?(h[h.length-1]+=r,k[h.length-1]+=x,C+=r.length-x.length):m=m.substring(0,s+u)+r+m.substring(s+x.length+u);s+=x.length-2;x=1;continue}else/[^@#$\w\[\].]/.test(r)&&(q=!0,0<a&&a--);if(!g){if(")"===r)if("|"===A&&/[!$a-z_]/i.test(u))y=!0;else{d&&d--;f.shift();continue}}else if(")"!==r||e)")"===r&&e&&e--,h[h.length-1]+=r,
k[h.length-1]+=r}x&&x--;"|"===A&&/[!$a-z_]/i.test(u)?(q=!1,g||(d?f[0].push(s+1):f.push([0,s+1])),h.push(u),k.push(u),e=0,g=!0,s+=2):g&&(")"===r&&!e||s===b.length-1)&&(g=f[0],r=p-C+l,A=d?m.substring(g[0]+l,g[1]+r):m.substring(0,g[1]+r),h=h.reduce(function(a,b){"!html"!==b?a.push(b):d||(t=!0);return a},[]),h=h.reduce(function(a,b){var c=b.split(" "),e=c.slice(1).join("").trim();return"Snakeskin.Filters['"+c.shift()+"']"+(y||!d?"(":"")+a+(e?","+e:"")+(y||!d?")":"")},A),k=k.join().length+1,m=d?m.substring(0,
g[0]+l)+h+m.substring(g[1]+r+k):h,l+=h.length-A.length-k+p-C,C=p=0,f.pop(),h=[],k=[],g=!1,d&&(d--,y=!1))}return(t||c?"":"Snakeskin.Filters.html(")+m+(t||c?"":")")};Snakeskin.Directions.end=function(b,c,a,d){a.openBlockI--;var e=arguments,f=a.openBlockI+1,g;0===a.openBlockI?Snakeskin.Directions.templateEnd.apply(Snakeskin,arguments):a.isNotSysPos(f)&&(Snakeskin.forEach(a.posCache,function(b,c){return(b=a.getLastPos(c))&&("undefined"!==typeof b.i&&b.i===f||b===f)?(g=!0,Snakeskin.Directions[c+"End"].apply(Snakeskin,
e),!1):!0}),g||(a.parentTplName||a.protoStart)||a.save("};"));Snakeskin.forEach(a.sysPosCache,function(b,c){return(b=a.getLastPos(c))&&("undefined"!==typeof b.i&&b.i===f||b===f)?(Snakeskin.Directions[c+"End"].apply(Snakeskin,e),!1):!0})};n.prototype.startI=0;n.prototype.openBlockI=0;n.prototype.tplName=null;n.prototype.parentTplName=null;n.prototype.nmCache={init:function(){return{}}};Snakeskin.Directions.template=function(b,c,a,d){a.startI=a.i+1;c=/(.*?)\(/.exec(b)[1];var e=a.pasteDangerBlocks(c,
a.quotContent);a.tplName=e;if(0!==a.openBlockI)throw a.error("Missing closing or opening tag in the template (command: {"+b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+'")!');a.openBlockI++;if(!d.dryRun){var f;/\s+extends\s+/.test(b)&&(f=a.pasteDangerBlocks(/\s+extends\s+(.*)/.exec(b)[1],a.quotContent),a.parentTplName=f);y[e]={};t[e]={};H[e]=0;u[e]={};I[e]=0;B[e]={};J[e]=f;var g=/\((.*?)\)/.exec(b)[1];a.save("/* Snakeskin template: "+e+"; "+g.replace(/=(.*?)(?:,|$)/g,"")+" */");if(/\.|\[/.test(c)||
d.commonJS){var h="";c.replace(/\[/g,".").replace(/]/g,"").split(".").reduce(function(b,c,e,f){a.nmCache[b]||(a.save("if (typeof "+(d.commonJS?"exports.":"")+b+" === 'undefined') { "+(d.commonJS?"exports.":1===e?G?"var ":"window.":"")+b+" = {}; }"),a.nmCache[b]=!0);if("__SNAKESKIN_QUOT__"===c.substring(0,18))return b+"["+c+"]";e===f.length-1&&(h=c);return b+"."+c});a.save((d.commonJS?"exports.":"")+c+"= function "+h+"(")}else a.save((G?"":"window."+c+" = ")+"function "+c+"(");g=g.split(",");z[e]=
z[f]?z[f].concat(g):g;z[f]&&Snakeskin.forEach(z[f],function(a){var b=a.split("=");b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();Snakeskin.forEach(g,function(c,e){var d=c.split("=");d[0]=d[0].trim();d[1]=d[1]&&d[1].trim();b[0]===d[0]&&"undefined"===typeof d[1]&&(g[e]=a)})});var k="";Snakeskin.forEach(g,function(b,c){var d=b.split("=");d[0]=d[0].trim();a.save(d[0]);1<d.length&&(z[f]&&!k&&Snakeskin.forEach(z[f],function(a){var b=a.split("="),c;b[0]=b[0].trim();b[1]=b[1]&&b[1].trim();Snakeskin.forEach(g,function(a){a=
a.split("=");a[0]=a[0].trim();a[1]=a[1]&&a[1].trim();return a[0]===b[0]?(c=!0,!1):!0});c||"undefined"===typeof b[1]||(k+="var "+b[0]+" = "+b[1]+";",B[e][b[0]]=a)}),d[1]=d[1].trim(),k+=d[0]+" = typeof "+d[0]+" !== 'undefined' && "+d[0]+" !== null ? "+d[0]+" : "+d[1]+";");B[e][d[0]]=b;c!==g.length-1&&a.save(",")});a.save(") { "+k+"var __SNAKESKIN_RESULT__ = '';");a.save("var TPL_NAME = '"+a.pasteDangerBlocks(c,a.quotContent).replace(/\\/g,"\\").replace(/'/g,"\\'")+"';");f&&a.save("var PARENT_TPL_NAME = '"+
a.pasteDangerBlocks(f,a.quotContent).replace(/\\/g,"\\").replace(/'/g,"\\'")+"';")}};Snakeskin.Directions.templateEnd=function(b,c,a,d){var e=a.tplName;if(a.backHashI)throw a.error('Proto "'+a.lastBack+'" is not defined (command: {'+b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+'")!');if(!d.dryRun){b=a.source;var f=a.i,g=a.startI;F[e]=b.substring(g,f-c-1);var h=a.parentTplName;if(h)return a.source=b.substring(0,g)+a.getExtStr(e,d.info)+b.substring(f-c-1),y[e]={},t[e]={},H[e]=0,u[e]={},I[e]=
0,B[e]={},a.i=g-1,a.openBlockI++,!1===Snakeskin.write[h]&&(a.res=a.res.replace(RegExp("/\\* Snakeskin template: "+h.replace(/([.\[\]^$])/g,"\\$1")+";[\\s\\S]*?/\\* Snakeskin template\\. \\*/","m"),"")),a.parentTplName=null,!1;a.save("return __SNAKESKIN_RESULT__; };if (typeof Snakeskin !== 'undefined') {Snakeskin.cache['"+a.pasteDangerBlocks(e,a.quotContent).replace(/\\/g,"\\").replace(/'/g,"\\'")+"'] = "+(d.commonJS?"exports.":"")+e+";}/* Snakeskin template. */");a.canWrite=!0;a.tplName=null}};Snakeskin.Directions.call=
function(b,c,a){a.parentTplName||a.protoStart||a.save("__SNAKESKIN_RESULT__ += "+b+";")};Snakeskin.Directions["void"]=function(b,c,a){a.parentTplName||a.protoStart||a.save(b)};n.prototype.varCache={init:function(){return{}}};Snakeskin.Directions["var"]=function(b,c,a,d){c=a.tplName;var e=b.split("=")[0].trim();if(u[c][e]||B[c][e])throw a.error('Variable "'+e+'" is already defined as constant (command: {var '+b+'}, template: "'+c+", "+a.genErrorAdvInfo(d.info)+'")!');a.varCache[e]=!0;a.parentTplName||
a.protoStart||a.save(a.prepareOutput("var "+b+";",!0))};Snakeskin.Directions.block=function(b,c,a,d){c=a.tplName;var e=a.parentTplName;if(!d.dryRun&&(e&&!a.hasPos("block")&&!a.hasPos("proto")||!e)){if(y[c][b])throw a.error('Block "'+b+'" is already defined (command: {block '+b+'}, template: "'+c+", "+a.genErrorAdvInfo(d.info)+'")!');y[c][b]={from:a.i-a.startI+1}}a.pushPos("block",{name:b,i:++a.openBlockI},!0)};Snakeskin.Directions.blockEnd=function(b,c,a,d){b=a.popPos("block");d.dryRun||(!a.parentTplName||
a.hasPos("block")||a.hasPos("proto"))&&a.parentTplName||(y[a.tplName][b.name].to=a.i-a.startI-c-1)};n.prototype.protoStart=!1;Snakeskin.Directions.proto=function(b,c,a,d){c=a.tplName;var e=a.parentTplName;if(!d.dryRun&&(e&&!a.hasPos("block")&&!a.hasPos("proto")||!e)){if(t[c][b])throw a.error('Proto "'+b+'" is already defined (command: {proto'+b+'}, template: "'+c+", "+a.genErrorAdvInfo(d.info)+'")!');t[c][b]={from:a.i-a.startI+1}}a.pushPos("proto",{name:b,i:++a.openBlockI,startI:a.i+1},!0);e||(a.protoStart=
!0)};Snakeskin.Directions.protoEnd=function(b,c,a,d){var e=a.tplName;b=a.parentTplName;var f=a.i,g=a.backHash,h=a.popPos("proto");d.dryRun||(!b||a.hasPos("block")||a.hasPos("proto"))&&b||(t[e][h.name].to=f-a.startI-c-1,H[e]=f-a.startI+1);b||(t[e][h.name].body=Snakeskin.compile("{template "+e+"()}"+a.source.substring(h.startI,f-c-1)+"{end}",null,null,!0,a.getPos("with")));g[h.name]&&!g[h.name].protoStart&&(Snakeskin.forEach(g[h.name],function(b){a.replace(a.res.substring(0,b)+t[e][h.name].body+a.res.substring(b))}),
delete g[h.name],a.backHashI--);a.hasPos("proto")||(a.protoStart=!1)};n.prototype.backHash={init:function(){return{}}};n.prototype.backHashI=0;n.prototype.lastBack=null;Snakeskin.Directions.apply=function(b,c,a){a.parentTplName||a.hasPos("proto")||(t[a.tplName][b]?a.save(t[a.tplName][b].body):(a.backHash[b]||(a.backHash[b]=[],a.backHash[b].protoStart=a.protoStart,a.lastBack=b,a.backHashI++),a.backHash[b].push(a.res.length)))};Snakeskin.Directions.forEach=function(b,c,a){a.pushPos("forEach",++a.openBlockI);
a.parentTplName||a.protoStart||(b=b.split("=>"),a.save(b[0]+" && Snakeskin.forEach("+b[0]+", function ("+(b[1]||"")+") {"))};Snakeskin.Directions.forEachEnd=function(b,c,a){a.popPos("forEach");a.parentTplName||a.protoStart||a.save("}, Snakeskin);")};Snakeskin.Directions["for"]=function(b,c,a){a.pushPos("for",++a.openBlockI);a.parentTplName||a.protoStart||a.save("for ("+a.prepareOutput(b,!0)+") {")};Snakeskin.Directions.forEnd=function(b,c,a){a.popPos("for");a.parentTplName||a.protoStart||a.save("}")};
Snakeskin.Directions["while"]=function(b,c,a){a.pushPos("while",++a.openBlockI);a.parentTplName||a.protoStart||a.save("while ("+a.prepareOutput(b,!0)+") {")};Snakeskin.Directions.whileEnd=function(b,c,a){a.popPos("while");a.parentTplName||a.protoStart||a.save("}")};Snakeskin.Directions.repeat=function(b,c,a){a.pushPos("repeat",++a.openBlockI);a.parentTplName||a.protoStart||a.save("do {")};Snakeskin.Directions.repeatEnd=function(b,c,a){a.popPos("repeat");a.parentTplName||a.protoStart||a.save("} while ("+
a.prepareOutput(b,!0)+");")};Snakeskin.Directions.until=Snakeskin.Directions.end;Snakeskin.Directions["if"]=function(b,c,a){a.openBlockI++;a.parentTplName||a.protoStart||a.save("if ("+a.prepareOutput(b,!0)+") {")};Snakeskin.Directions.elseIf=function(b,c,a){a.parentTplName||a.protoStart||a.save("} else if ("+a.prepareOutput(b,!0)+") {")};Snakeskin.Directions["else"]=function(b,c,a){a.parentTplName||a.protoStart||a.save("} else {")};Snakeskin.Directions["with"]=function(b,c,a){a.pushPos("with",{scope:b,
i:++a.openBlockI},!0)};Snakeskin.Directions.withEnd=function(b,c,a){a.popPos("with")};Snakeskin.Directions["const"]=function(b,c,a,d){var e=a.tplName,f=a.parentTplName,g=a.protoStart,h=a.i,k=a.startI;if(f||g||!/^console\./.test(b))if(/^[@#$a-z_][$\w\[\].'"\s]*[^=]=[^=]/i.test(b)){var m=b.split("=")[0].trim(),l=m.charAt(0);if(e){if(!(d.dryRun||a.varCache[m]||"#"===l||"@"===l||(!f||a.hasPos("block")||a.hasPos("proto"))&&f)){if(u[e][m]||B[e][m])throw a.error('Constant "'+m+'" is already defined (command: {'+
b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+'")!');if(W[m])throw a.error("Can't declare constant \""+m+'", try another name (command: {'+b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+'")!');if(a.hasPos("forEach"))throw a.error('Constant "'+m+"\" can't be defined in a loop (command: {"+b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+'")!');if(a.hasPos("with"))throw a.error('Constant "'+m+'" can\'t be defined inside a "with" block (command: {'+b+'}, template: "'+e+", "+a.genErrorAdvInfo(d.info)+
'")!');u[e][m]={from:h-k-c,to:h-k};I[e]=h-k+1}f||g||(a.varCache[m]||"#"===l||"@"===l?a.save(a.prepareOutput(b+";",!0)):a.save(a.prepareOutput((/[.\[]/.test(m)?"":"var ")+b+";",!0)))}else a.save("if (typeof Snakeskin !== 'undefined') { Snakeskin.Vars."+a.prepareOutput(b,!0,!0)+"; }")}else f||g||a.save("__SNAKESKIN_RESULT__ += "+a.prepareOutput(b)+";");else a.save(b+";")};Snakeskin.Directions.cut=function(b,c,a){b=a.pasteDangerBlocks(b,a.quotContent);Snakeskin.write[b]||(Snakeskin.write[b]=!1)};Snakeskin.Directions.save=
function(b,c,a){Snakeskin.write[a.pasteDangerBlocks(b,a.quotContent)]=!0};Snakeskin.Directions.setBEM=function(b,c,a){b=b.match(/(.*?),\s+(.*)/);Snakeskin.BEM[b[1]]=(new Function("return {"+a.pasteDangerBlocks(b[2],a.quotContent)+"}"))()};Snakeskin.Directions.bem=function(b,c,a){a.pushPos("bem",{i:++a.openBlockI,tag:/^\(/g.test(b)?/\((.*?)\)/.exec(b)[1]:null});c=a.getLastPos("bem");b=c.tag?b.replace(/^.*?\)([\s\S]*)/,"$1"):b;b=b.trim().split(",");var d=b[0];c.original=Snakeskin.BEM[d]&&Snakeskin.BEM[d].tag;
a.parentTplName||a.protoStart||(b[0]+="'",b=b.join(","),a.save("__SNAKESKIN_RESULT__ += '<"+(c.tag||c.original||"div")+' class="i-block" data-params="{name: \\\''+a.replaceTplVars(b)+"}\">';"))};Snakeskin.Directions.bemEnd=function(b,c,a){b=a.popPos("bem");a.parentTplName||a.protoStart||a.save("__SNAKESKIN_RESULT__ += '</"+(b.tag||b.original||"div")+">';")};Snakeskin.Directions.data=function(b,c,a){a.parentTplName||a.protoStart||a.save("__SNAKESKIN_RESULT__ += '"+a.replaceTplVars(b)+"';")};G&&(module.exports=
Snakeskin)})("undefined"===typeof window);
